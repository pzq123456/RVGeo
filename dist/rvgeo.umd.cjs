(function(m,tt){typeof exports=="object"&&typeof module<"u"?tt(exports):typeof define=="function"&&define.amd?define(["exports"],tt):(m=typeof globalThis<"u"?globalThis:m||self,tt(m.RVGeo={}))})(this,function(m){"use strict";var Fs=Object.defineProperty;var ks=(m,tt,Dt)=>tt in m?Fs(m,tt,{enumerable:!0,configurable:!0,writable:!0,value:Dt}):m[tt]=Dt;var H=(m,tt,Dt)=>ks(m,typeof tt!="symbol"?tt+"":tt,Dt);const tt=Math.PI/180,Dt=180/Math.PI,dt=63710088e-1,Se={centimeters:dt*100,centimetres:dt*100,degrees:360/(2*Math.PI),feet:dt*3.28084,inches:dt*39.37,kilometers:dt/1e3,kilometres:dt/1e3,meters:dt,metres:dt,miles:dt/1609.344,millimeters:dt*1e3,millimetres:dt*1e3,nauticalmiles:dt/1852,radians:1,yards:dt*1.0936},Ie={centimeters:1*100,centimetres:1*100,degrees:360/(2*Math.PI)*1/dt,feet:1*3.28084,inches:1*39.37,kilometers:1/1e3,kilometres:1/1e3,meters:1,metres:1,miles:1/1609.344,millimeters:1*1e3,millimetres:1*1e3,nauticalmiles:1/1852,radians:1/dt,yards:1*1.0936},Ce={acres:247105e-9,centimeters:1e4,centimetres:1e4,squaremeters:1,squaremetres:1,feet:10.763910417,hectares:1e-4,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,squarekilometers:1e-6,squarekilometres:1e-6,meters:1,metres:1,miles:386e-9,nauticalmiles:29155334959812285e-23,millimeters:1e6,millimetres:1e6,yards:1.195990046};function Bi(e,t="kilometers"){const n=Se[t];if(!n)throw new Error(t+" units is invalid");return e*n}function Gi(e,t="kilometers"){const n=Se[t];if(!n)throw new Error(t+" units is invalid");return e/n}function Fe(e){return e%360*Math.PI/180}function Li(e){return e%(2*Math.PI)*180/Math.PI}function ln(e,t){const n=Ie[t];if(!n)throw new Error(t+" units is invalid");return e/n}function un(e,t){const n=Ie[t];if(!n)throw new Error(t+" units is invalid");return e*n}function _i(e,t,n){return un(ln(e,t),n)}function hn(e,t){const n=Ce[t];if(!n)throw new Error(t+" units is invalid");return e/n}function fn(e,t){const n=Ce[t];if(!n)throw new Error(t+" units is invalid");return e*n}function ji(e,t,n){return fn(hn(e,t),n)}function Ri(e,t,n,i){let r=e+t/60+n/3600;return(i==="S"||i==="W")&&(r=-r),r}function Oi(e){let t=Math.floor(e),n=Math.floor((e-t)*60),i=((e-t)*60-n)*60;return[t,n,i,e<0?e<-180?"W":"S":e>180?"E":"N"]}const ke=Math.PI,Be=ke/2,cn=Math.atan2,Ge=Math.cos,ae=Math.sin,le=Math.sqrt,dn=1e-10;function qi(e,t,n=dn){return!Array.isArray(e)&&!Array.isArray(t)?Math.abs(e-t)<n:Array.isArray(e)&&Array.isArray(t)?e.length===t.length&&e.every((i,r)=>Math.abs(i-t[r])<n):!1}function yn(e){return e>1?0:e<-1?ke:Math.acos(e)}function mn(e){return e>1?Be:e<-1?-Be:Math.asin(e)}function Di(e){return(e=ae(e/2))*e}function Jt(e){return[cn(e[1],e[0]),mn(e[2])]}function Kt(e,t=!0){t&&(e=[Fe(e[0]),Fe(e[1])]);const n=e[0],i=e[1],r=Ge(i);return[r*Ge(n),r*ae(n),ae(i)]}function ue(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function he(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ni(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Yi(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]}function gn(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function Wi(e){var t=le(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function wn(e){const t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]}function fe(e,t){let n=ue(e,t)/le(ue(e,e)*ue(t,t));return yn(n)}function Xi(e,t){return e[0]*t[0]+e[1]*t[1]}function Gt(e,t){return e[0]*t[1]-e[1]*t[0]}function $i(e,t){return[e[0]+t[0],e[1]+t[1]]}function zi(e,t){return[e[0]*t,e[1]*t]}function Ui(e){var t=le(e[0]*e[0]+e[1]*e[1]);return[e[0]/t,e[1]/t]}function Vi(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n,e[2]+(t[2]-e[2])*n]}function Hi(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function Ji(e,t){if(typeof t=="number"||t===void 0){const n=Math.pow(10,t===void 0?6:t);return Math.round(e*n)/n}return e}function Ki(e){return Number(e)===e&&e%1!==0}function Le(e,t=1){let n=e.slice();if(n.length<3)return 0;let i=0,r=n.length;n.forEach((o,s)=>{n[s]=o.map(a=>a*tt)});for(let o=0;o<r;o++){let s=(o+1)%r,a=(o+2)%r;i+=(n[o][0]-n[a][0])*Math.sin(n[s][1])}return i*=t*t/2,Math.abs(i)}function Mn(e,t=1){let n=Pt.isLineString(e)?e.toXY():e;if(n.length<3)return 0;ut.isPoint(n[0])&&(n=n,n.map((o,s)=>{n[s]=o.toXY()})),n=n;let i=0,r=n.length-1;for(let o=0;o<n.length;o++)i+=(n[r][0]+n[o][0])*(n[r][1]-n[o][1]),r=o;return i=i*t*t/2,Math.abs(i)}function Qt(e,t,n=1){let i=Math.PI/180,r=e[0]*i,o=t[0]*i,s=Math.sin((t[0]-e[0])*i/2),a=Math.sin((t[1]-e[1])*i/2),l=s*s+Math.cos(r)*Math.cos(o)*a*a,h=2*Math.atan2(Math.sqrt(l),Math.sqrt(1-l));return n*h}function Qi(e,t){let n=e[0]*tt,i=t[0]*tt,r=e[1]*tt,o=t[1]*tt;const s=Math.sin(o-r)*Math.cos(i),a=Math.cos(n)*Math.sin(i)-Math.sin(n)*Math.cos(i)*Math.cos(o-r);return(Math.atan2(s,a)*180/Math.PI+360)%360}function Zi(e,t){let n=e[0]*tt,i=e[1]*tt,r=t[0]*tt,o=t[1]*tt;const s=Math.cos(r)*Math.cos(o-i),a=Math.cos(r)*Math.sin(o-i),l=Math.atan2(Math.sin(n)+Math.sin(r),Math.sqrt((Math.cos(n)+s)*(Math.cos(n)+s)+a*a)),h=i+Math.atan2(a,Math.cos(n)+s);return[l/tt,h/tt]}function tr(e,t,n){let i=e[0]*tt,r=e[1]*tt,o=t[0]*tt,s=t[1]*tt,a=Qt(e,t);const l=Math.sin((1-n)*a)/Math.sin(a),h=Math.sin(n*a)/Math.sin(a),f=l*Math.cos(i)*Math.cos(r)+h*Math.cos(o)*Math.cos(s),u=l*Math.cos(i)*Math.sin(r)+h*Math.cos(o)*Math.sin(s),c=l*Math.sin(i)+h*Math.sin(o),d=Math.atan2(c,Math.sqrt(f*f+u*u)),g=Math.atan2(u,f);return[d/tt,g/tt]}function er(e,t,n,i){const r=Kt(e),o=Kt(t),s=Kt(n),a=Kt(i),l=he(r,o),h=he(s,a),f=he(l,h),u=wn(f),c=gn(u,-1);if(d(c,r,o)||d(c,s,a))return Jt(c);if(d(u,r,o)||d(u,s,a))return Jt(u);return[0,0];function d(g,M,A){const p=fe(M,g),E=fe(A,g),G=fe(M,A);return Math.abs(p+E-G)<1e-6}}function nr(e,t,n){let i=e[0]*tt,r=e[1]*tt,o=t*tt,s=6378137;const a=Math.asin(Math.sin(i)*Math.cos(n/s)+Math.cos(i)*Math.sin(n/s)*Math.cos(o)),l=r+Math.atan2(Math.sin(o)*Math.sin(n/s)*Math.cos(i),Math.cos(n/s)-Math.sin(i)*Math.sin(a));return[a/tt,l/tt]}function ir(e,t,n,i,r,o,s=!1){r&&(e=r(e),t=r(t),n=r(n),i=r(i));let a=[t[0]-e[0],t[1]-e[1]],l=[i[0]-n[0],i[1]-n[1]],h=Gt(a,l);if(h===0)return console.log("两条线段平行或共线"),null;let f=Gt([n[0]-e[0],n[1]-e[1]],l)/h,u=Gt([n[0]-e[0],n[1]-e[1]],a)/h;return!s&&(f<0||f>1||u<0||u>1)?(console.log("交点不在两条线段上"),null):o?o([e[0]+a[0]*f,e[1]+a[1]*f]):[e[0]+a[0]*f,e[1]+a[1]*f]}function rr(e,t,n,i,r=1,o=1){let s=new Array(t),a=(i-n)/t;for(let l=0;l<t;l++)s[l]=e(2*Math.PI*r*(n+l*a))*o;return s}function ce(e,t){return{real:e.real*t.real-e.imag*t.imag,imag:e.real*t.imag+e.imag*t.real}}function bn(e,t){return{real:e.real+t.real,imag:e.imag+t.imag}}function vn(e,t){return{real:e.real-t.real,imag:e.imag-t.imag}}function pn(e,t){let n=-2*Math.PI*e/t;return{real:Math.cos(n),imag:Math.sin(n)}}function or(e){return e.imag*=-1,e}function sr(e,t){let n=[];for(let i=0;i<t;i++)n.push({real:e[i],imag:0});return n}function Pn(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=e[ar(i,t)];return n}function ar(e,t){let n=e.toString(2);return n=n.split("").reverse().join(""),n=n+"0".repeat(Math.log2(t)-n.length),parseInt(n,2)}function An(e){let t=e.length,n=sr(e,t),r=Pn(n).slice();for(let o=1;o<Math.log2(t)+1;o++){let s=Math.pow(2,o),a=pn(1,s);for(let l=0;l<t;l+=s){let h={real:1,imag:0};for(let f=0;f<s/2;f++){let u=ce(h,r[l+f+s/2]),c=r[l+f];r[l+f]=bn(c,u),r[l+f+s/2]=vn(c,u),h=ce(h,a)}}}return r}function lr(e){let n=_e(e).map(r=>r.map(o=>Math.sqrt(o.real*o.real+o.imag*o.imag)));return Gn(_e(n,"column"))}function En(e){let t=e.length,i=Pn(e).slice();for(let r=1;r<Math.log2(t)+1;r++){let o=Math.pow(2,r),s=pn(-1,o);for(let a=0;a<t;a+=o){let l={real:1,imag:0};for(let h=0;h<o/2;h++){let f=ce(l,i[a+h+o/2]),u=i[a+h];i[a+h]=bn(u,f),i[a+h+o/2]=vn(u,f),l=ce(l,s)}}}for(let r=0;r<t;r++)i[r].real/=t,i[r].imag/=t;return i}function Tn(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=Fn(e[i]);return n}function xn(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=e[i].real;return n}function ur(e,t="row"){return t==="row"?Sn(e):de(Sn(Nt(e)))}function Sn(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=xn(e[i]);return n}function _e(e,t="row"){return t==="row"?In(e):Nt(In(de(e)))}function In(e){let t=e[0].length,n=e.length;if(Math.log2(t)%1!==0){let r=Math.pow(2,Math.ceil(Math.log2(t)));for(let o=0;o<n;o++)e[o]=e[o].concat(new Array(r-t).fill(0))}let i=new Array(n);for(let r=0;r<n;r++)i[r]=An(e[r]);return i}function hr(e,t="row"){return t==="row"?Cn(e):Nt(Cn(Nt(e)))}function Cn(e){let t=e[0].length,n=e.length;if(Math.log2(t)%1!==0){let r=Math.pow(2,Math.ceil(Math.log2(t)));for(let o=0;o<n;o++)e[o]=e[o].concat(new Array(r-t).fill({real:0,imag:0}))}let i=new Array(n);for(let r=0;r<n;r++)i[r]=En(e[r]);return i}function de(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++){n[i]=new Array(t);for(let r=0;r<t;r++)n[i][r]=e[r][i]}return n}function Nt(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++){n[i]=new Array(t);for(let r=0;r<t;r++)n[i][r]=e[r][i]}return n}function Fn(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=e[i].imag;return n}function fr(e,t="row"){return t==="row"?Tn(e):de(Tn(Nt(e)))}function kn(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=e[i].real;return n}function Bn(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++)n[i]=kn(e[i]);return n}function cr(e,t="row"){return t==="row"?Bn(e):de(Bn(Nt(e)))}function Gn(e){let t=e.length,n=new Array(t);for(let i=0;i<t;i++){n[i]=new Array(t);for(let r=0;r<t;r++)n[i][r]=e[(i+t/2)%t][(r+t/2)%t]}return n}function dr(e,t){t.forEach(n=>{Object.getOwnPropertyNames(n.prototype).forEach(i=>{Object.defineProperty(e.prototype,i,Object.getOwnPropertyDescriptor(n.prototype,i)||Object.create(null))})})}function Ln(e){return typeof e!="object"?!1:e.x&&e.y||e.lon&&e.lat||e.lng&&e.lat?!0:!!(e.X&&e.Y)}function yr(e,t){let n=0;return function(...i){const r=Date.now();r-n>t&&(e.apply(this,i),n=r)}}function je(e,...t){for(let n=0,i=t.length;n<i;n++){const r=t[n];for(const o in r)e[o]=r[o]}return e}function mr(e){for(let t in e)delete e[t]}function gr(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e==="x"?t:t&3|8).toString(16)})}function wr(e){let t=[],n=e;for(;Array.isArray(n);)t.push(n.length),n=n[0];return t}function _n(e){let t=[];for(let n=0;n<e.length;n++){let i=e[n];Array.isArray(i)?t.push(..._n(i)):t.push(i)}return t}function jn(e,t){let n=[];for(let i=0;i<e.length;i++){let r=e[i];Array.isArray(r)?n.push(jn(r,t)):n.push(t[r])}return n}function Mr(e,t){return e.forEach((n,i)=>{e[i]=n.concat(t[i])}),e}function br(e,t){Array.isArray(t)||(t=[t]),t.forEach(i=>{if(i<0||i>=e[0].length)throw new Error("indexArray is illegal!")});let n=[];return e.forEach(i=>{let r=[];Array.isArray(t)?t.forEach(o=>{r.push(i[o])}):r.push(i[t]),n.push(r)}),n}function Rn(e,t){if(t>e)throw new Error("num must be less than length!");const n=[];for(;n.length<t;){const i=Math.floor(Math.random()*e);n.includes(i)||n.push(i)}return n}function vr(e,t=0){if(t&&!(t>=0))throw new Error("precision must be a positive number");const n=Math.pow(10,t||0);return Math.round(e*n)/n}class pr{constructor(){H(this,"_events",{});H(this,"_asyncEvents",{})}on(t,n,i){return n.constructor.name==="AsyncFunction"?(this._asyncEvents[t]||(this._asyncEvents[t]=[]),this._asyncEvents[t].push({fn:n,context:i})):(this._events[t]||(this._events[t]=[]),this._events[t].push({fn:n,context:i})),this}off(t,n,i){if(!this._events[t])return this;if(this._events[t])if(!n&&!i)delete this._events[t];else{const r=this._events[t];for(let o=0;o<r.length;o++){const s=r[o];(!n||s.fn===n)&&(!i||s.context===i)&&(r.splice(o,1),o--)}}if(this._asyncEvents[t])if(!n&&!i)delete this._asyncEvents[t];else{const r=this._asyncEvents[t];for(let o=0;o<r.length;o++){const s=r[o];(!n||s.fn===n)&&(!i||s.context===i)&&(r.splice(o,1),o--)}}return this}once(t,n,i){const r=(...o)=>{n.apply(this,o),this.off(t,r)};return this.on(t,r,i)}emit(t,n){if(!this._events[t])return this;const i={type:t,target:this,...n};return this._events[t].slice().forEach(o=>{o.fn.call(o.context||this,i),o.once&&this.off(t,o.fn,o.context)}),this}async emitAsync(t,n,i){if(!this._asyncEvents[t])return;const r={type:t,target:this,...i},o=this._asyncEvents[t].slice();if(n==="parallel")await Promise.all(o.map(s=>s.fn.call(s.context||this,r)));else if(n==="series")for(const s of o)await s.fn.call(s.context||this,r);else n==="ignore"&&o.forEach(s=>s.fn.call(s.context||this,r))}listeners(t){return[...this._events[t]||[],...this._asyncEvents[t]||[]]}hasListeners(t){var n,i;return!!((n=this._events[t])!=null&&n.length||(i=this._asyncEvents[t])!=null&&i.length)}removeAllListeners(){return this._events={},this._asyncEvents={},this}static isAsyncListener(t){return t.fn.constructor.name==="AsyncFunction"}}function Pr(e){let t=e.length,n=0,i=0;for(let r=0;r<t;r++)n+=e[r][0],i+=e[r][1];return[n/t,i/t]}function Ar(e,t=1e-4,n=100,i){let r=[],o=i.length;if(o<e){console.log("样本数量小于分类数量");return}Rn(o,e).forEach(f=>{let u=i[f];r.push(u)});let a=1/0,l=0,h=[];for(;a>t&&l<n;){h=[];for(let u=0;u<e;u++)h.push([]);for(let u=0;u<o;u++){let c=1/0,d=0,g=i[u];for(let M=0;M<e;M++){let A=i[u],p=r[M],E=Qt(A,p);E<c&&(c=E,d=M)}h[d].push(g)}let f=[];for(let u=0;u<e;u++)f.push(Pr(h[u]));a=0;for(let u=0;u<e;u++){let c=r[u],d=f[u],g=Qt(c,d);g>a&&(a=g)}console.log(a),r=f,l++}return h}const Er=Object.prototype.hasOwnProperty;function Tr(e){var t=1/0,n=1/0,i=-1/0,r=-1/0;function o(f){f!=null&&f.type&&Er.call(s,f.type)&&s[f.type](f)}const s={GeometryCollection:function(f){f.geometries.forEach(o)},Point:function(f){a(f.coordinates)},MultiPoint:function(f){f.coordinates.forEach(a)},LineString:function(f){l(f.arcs)},MultiLineString:function(f){f.arcs.forEach(l)},Polygon:function(f){f.arcs.forEach(l)},MultiPolygon:function(f){f.arcs.forEach(h)}};function a(f){var u=f[0],c=f[1];u<t&&(t=u),u>i&&(i=u),c<n&&(n=c),c>r&&(r=c)}function l(f){f.forEach(a)}function h(f){f.forEach(l)}for(let f in e)o(e[f]);return i>=t&&r>=n?[t,n,i,r]:void 0}function xr(e,t,n,i=Array,r=null){for(var o=new i(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),s=e-1,a=0;a<e;++a)o[a]=r;function l(u){for(var c=t(u)&s,d=o[c],g=0;d!=r;){if(n(d,u))return!0;if(++g>=e)throw new Error("full hashset");d=o[c=c+1&s]}return o[c]=u,!0}function h(u){for(var c=t(u)&s,d=o[c],g=0;d!=r;){if(n(d,u))return!0;if(++g>=e)break;d=o[c=c+1&s]}return!1}function f(){for(var u=[],c=0,d=o.length;c<d;++c){var g=o[c];g!=r&&u.push(g)}return u}return{add:l,has:h,values:f}}function Re(e,t,n,i=Array,r=null,o=Array){for(var s=new i(e=1<<Math.max(4,Math.ceil(Math.log(e)/Math.LN2))),a=new o(e),l=e-1,h=0;h<e;++h)s[h]=r;function f(g,M){for(var A=t(g)&l,p=s[A],E=0;p!=r;){if(n(p,g))return a[A]=M;if(++E>=e)throw new Error("full hashmap");p=s[A=A+1&l]}return s[A]=g,a[A]=M,M}function u(g,M){for(var A=t(g)&l,p=s[A],E=0;p!=r;){if(n(p,g))return a[A];if(++E>=e)throw new Error("full hashmap");p=s[A=A+1&l]}return s[A]=g,a[A]=M,M}function c(g,M){for(var A=t(g)&l,p=s[A],E=0;p!=r;){if(n(p,g))return a[A];if(++E>=e)break;p=s[A=A+1&l]}return M}function d(){for(var g=[],M=0,A=s.length;M<A;++M){var p=s[M];p!=r&&g.push(p)}return g}return{set:f,maybeSet:u,get:c,keys:d}}function Lt(e,t){return e[0]===t[0]&&e[1]===t[1]}let On=new ArrayBuffer(16),qn=new Float64Array(On),ye=new Uint32Array(On);function Oe(e){qn[0]=e[0],qn[1]=e[1];var t=ye[0]^ye[1];return t=t<<5^t>>7^ye[2]^ye[3],t&2147483647}function Sr(e){var t=e.coordinates,n=e.lines,i=e.rings,r=j(),o=new Int32Array(t.length),s=new Int32Array(t.length),a=new Int32Array(t.length),l=new Int8Array(t.length),h=0,f,u,c,d,g;for(f=0,u=t.length;f<u;++f)o[f]=s[f]=a[f]=-1;for(f=0,u=n.length;f<u;++f){var M=n[f],A=M[0],p=M[1];for(d=r[A],g=r[++A],++h,l[d]=1;++A<=p;)F(f,c=d,d=g,g=r[A]);++h,l[g]=1}for(f=0,u=t.length;f<u;++f)o[f]=-1;for(f=0,u=i.length;f<u;++f){var E=i[f],G=E[0]+1,L=E[1];for(c=r[L-1],d=r[G-1],g=r[G],F(f,c,d,g);++G<=L;)F(f,c=d,d=g,g=r[G])}function F(R,z,U,y){if(o[U]!==R){o[U]=R;var w=s[U];if(w>=0){var b=a[U];(w!==z||b!==y)&&(w!==y||b!==z)&&(++h,l[U]=1)}else s[U]=z,a[U]=y}}function j(){for(var R=Re(t.length*1.4,Y,X,Int32Array,-1,Int32Array),z=new Int32Array(t.length),U=0,y=t.length;U<y;++U)z[U]=R.maybeSet(U,U);return z}function Y(R){return Oe(t[R])}function X(R,z){return Lt(t[R],t[z])}o=s=a=null;var I=xr(h*1.4,Oe,Lt),W;for(f=0,u=t.length;f<u;++f)l[W=r[f]]&&I.add(t[W]);return I}function Ir(e){var t=Sr(e),n=e.coordinates,i=e.lines,r=e.rings,o,s,a;for(s=0,a=i.length;s<a;++s)for(var l=i[s],h=l[0],f=l[1];++h<f;)t.has(n[h])&&(o={0:h,1:l[1]},l[1]=h,l=l.next=o);for(s=0,a=r.length;s<a;++s)for(var u=r[s],c=u[0],d=c,g=u[1],M=t.has(n[c]);++d<g;)t.has(n[d])&&(M?(o={0:d,1:u[1]},u[1]=d,u=u.next=o):(Cr(n,c,g,g-d),n[g]=n[c],M=!0,d=c));return e}function Cr(e,t,n,i){qe(e,t,n),qe(e,t,t+i),qe(e,t+i,n)}function qe(e,t,n){for(var i=t+(n---t>>1),r;t<i;++t,--n)r=e[t],e[t]=e[n],e[n]=r}function Fr(e){let t=e.coordinates,n=e.lines,i,r=e.rings,o,s=n.length+r.length,a,l;for(delete e.lines,delete e.rings,a=0,l=n.length;a<l;++a)for(i=n[a];i=i.next;)++s;for(a=0,l=r.length;a<l;++a)for(o=r[a];o=o.next;)++s;let h=Re(s*2*1.4,Oe,Lt),f=e.arcs=[];for(a=0,l=n.length;a<l;++a){i=n[a];do u(i);while(i=i.next)}for(a=0,l=r.length;a<l;++a)if(o=r[a],o.next)do u(o);while(o=o.next);else c(o);function u(E){let G,L,F,j,Y,X,I,W;if(F=h.get(G=t[E[0]])){for(I=0,W=F.length;I<W;++I)if(j=F[I],d(j,E)){E[0]=j[0],E[1]=j[1];return}}if(Y=h.get(L=t[E[1]])){for(I=0,W=Y.length;I<W;++I)if(X=Y[I],g(X,E)){E[1]=X[0],E[0]=X[1];return}}F?F.push(E):h.set(G,[E]),Y?Y.push(E):h.set(L,[E]),f.push(E)}function c(E){let G,L,F,j,Y;if(L=h.get(G=t[E[0]]))for(j=0,Y=L.length;j<Y;++j){if(F=L[j],M(F,E)){E[0]=F[0],E[1]=F[1];return}if(A(F,E)){E[0]=F[1],E[1]=F[0];return}}if(L=h.get(G=t[E[0]+p(E)]))for(j=0,Y=L.length;j<Y;++j){if(F=L[j],M(F,E)){E[0]=F[0],E[1]=F[1];return}if(A(F,E)){E[0]=F[1],E[1]=F[0];return}}L?L.push(E):h.set(G,[E]),f.push(E)}function d(E,G){let L=E[0],F=G[0],j=E[1],Y=G[1];if(L-j!==F-Y)return!1;for(;L<=j;++L,++F)if(!Lt(t[L],t[F]))return!1;return!0}function g(E,G){let L=E[0],F=G[0],j=E[1],Y=G[1];if(L-j!==F-Y)return!1;for(;L<=j;++L,--Y)if(!Lt(t[L],t[Y]))return!1;return!0}function M(E,G){let L=E[0],F=G[0],j=E[1],Y=G[1],X=j-L;if(X!==Y-F)return!1;let I=p(E),W=p(G);for(let R=0;R<X;++R)if(!Lt(t[L+(R+I)%X],t[F+(R+W)%X]))return!1;return!0}function A(E,G){let L=E[0],F=G[0],j=E[1],Y=G[1],X=j-L;if(X!==Y-F)return!1;let I=p(E),W=X-p(G);for(let R=0;R<X;++R)if(!Lt(t[L+(R+I)%X],t[Y-(R+W)%X]))return!1;return!0}function p(E){let G=E[0],L=E[1],F=G,j=F,Y=t[F];for(;++F<L;){let X=t[F];(X[0]<Y[0]||X[0]===Y[0]&&X[1]<Y[1])&&(j=F,Y=X)}return j-G}return e}function kr(e){for(var t=-1,n=e.length;++t<n;){for(var i=e[t],r=0,o=1,s=i.length,a=i[0],l=a[0],h=a[1],f,u;++r<s;)a=i[r],f=a[0],u=a[1],(f!==l||u!==h)&&(i[o++]=[f-l,u-h],l=f,h=u);o===1&&(i[o++]=[0,0]),i.length=o}return e}const Br=Object.prototype.hasOwnProperty;function Gr(e){let t=-1,n=[],i=[],r=[];function o(u){u&&u.type&&Br.call(s,u.type)&&s[u.type](u)}const s={GeometryCollection:function(u){u.geometries.forEach(o)},LineString:function(u){u.arcs=a(u.arcs)},MultiLineString:function(u){u.arcs=u.arcs.map(a)},Polygon:function(u){u.arcs=u.arcs.map(l)},MultiPolygon:function(u){u.arcs=u.arcs.map(h)}};function a(u){for(var c=0,d=u.length;c<d;++c)n[++t]=u[c];var g={0:t-d+1,1:t};return i.push(g),g}function l(u){for(var c=0,d=u.length;c<d;++c)n[++t]=u[c];var g={0:t-d+1,1:t};return r.push(g),g}function h(u){return u.map(l)}for(var f in e)o(e[f]);return{type:"Topology",coordinates:n,lines:i,rings:r,objects:e}}function Lr(e){var t={},n;for(n in e)t[n]=_r(e[n]);return t}function _r(e){return e==null?{type:null}:e.type==="FeatureCollection"?jr(e):e.type==="Feature"?Dn(e):De(e)}function jr(e){var t={type:"GeometryCollection",geometries:e.features.map(Dn)};return e.bbox!=null&&(t.bbox=e.bbox),t}function Dn(e){var t=De(e.geometry),n;e.id!=null&&(t.id=e.id),e.bbox!=null&&(t.bbox=e.bbox);for(n in e.properties){t.properties=e.properties;break}return t}function De(e){if(e==null)return{type:null};let t={};if(e.type==="GeometryCollection")e=e,t={type:"GeometryCollection",geometries:e.geometries.map(De)},e.bbox!=null&&(t.bbox=e.bbox);else if(e.type==="Point"||e.type==="MultiPoint")t={type:e.type,coordinates:e.coordinates};else if(e.type==="LineString"||e.type==="MultiLineString"||e.type==="Polygon"||e.type==="MultiPolygon")e=e,t={type:e.type,arcs:e.coordinates};else throw new Error("Unknown geometry type: "+e.type);return t}const Rr=Object.prototype.hasOwnProperty;function Or(e,t,n){var i=t[0],r=t[1],o=t[2],s=t[3],a=o-i?(n-1)/(o-i):1,l=s-r?(n-1)/(s-r):1;function h(p){return[Math.round((p[0]-i)*a),Math.round((p[1]-r)*l)]}function f(p,E){for(var G=-1,L=0,F=p.length,j=new Array(F),Y,X,I,W,R;++G<F;)Y=p[G],W=Math.round((Y[0]-i)*a),R=Math.round((Y[1]-r)*l),(W!==X||R!==I)&&(j[L++]=[X=W,I=R]);for(j.length=L;L<E;)L=j.push([j[0][0],j[0][1]]);return j}function u(p){return f(p,2)}function c(p){return f(p,4)}function d(p){return p.map(c)}function g(p){p!=null&&p.type&&Rr.call(M,p.type)&&M[p.type](p)}const M={GeometryCollection:function(p){p.geometries.forEach(g)},Point:function(p){p.coordinates=h(p.coordinates)},MultiPoint:function(p){p.coordinates=p.coordinates.map(h)},LineString:function(p){p.arcs=u(p.arcs)},MultiLineString:function(p){p.arcs=p.arcs.map(u)},Polygon:function(p){p.arcs=d(p.arcs)},MultiPolygon:function(p){p.arcs=p.arcs.map(d)}};for(var A in e)g(e[A]);return{scale:[1/a,1/l],translate:[i,r]}}const qr=Object.prototype.hasOwnProperty;function Dr(e,t){let n=Lr(e);var i=Tr(n),r=t>0&&i&&Or(n,i,t),o=Fr(Ir(Gr(n))),s=o.coordinates,a=Re(o.arcs.length*1.4,Nr,Yr);o.bbox=i,o.arcs=o.arcs.map(function(d,g){return a.set(d,g),s.slice(d[0],d[1]+1)}),delete o.coordinates,s=null;function l(d){d&&d.type&&qr.call(h,d.type)&&h[d.type](d)}var h={GeometryCollection:function(d){d.geometries.forEach(l)},LineString:function(d){d.arcs=f(d.arcs)},MultiLineString:function(d){d.arcs=d.arcs.map(f)},Polygon:function(d){d.arcs=d.arcs.map(f)},MultiPolygon:function(d){d.arcs=d.arcs.map(u)}};function f(d){var g=[];do{var M=a.get(d);g.push(d[0]<d[1]?M:~M)}while(d=d.next);return g}function u(d){return d.map(f)}for(var c in n)l(n[c]);return r&&(o.transform=r,o.arcs=kr(o.arcs)),o}function Nr(e){var t=e[0],n=e[1],i;return n<t&&(i=t,t=n,n=i),t+31*n}function Yr(e,t){var n=e[0],i=e[1],r=t[0],o=t[1],s;return i<n&&(s=n,n=i,i=s),o<r&&(s=r,r=o,o=s),n===r&&i===o}function Nn(e){return e}function Yn(e,t){for(var n=0,i=e.length;n<i;){var r=n+i>>>1;e[r]<t?n=r+1:i=r}return n}function Wn(e){if(!e)return Nn;let t,n,i=e.scale[0],r=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,l){l||(t=n=0);var h=2,f=a.length,u=new Array(f);for(u[0]=(t+=a[0])*i+o,u[1]=(n+=a[1])*r+s;h<f;)u[h]=a[h],++h;return u}}function Wr(e){if(!e)return Nn;var t,n,i=e.scale[0],r=e.scale[1],o=e.translate[0],s=e.translate[1];return function(a,l){l||(t=n=0);var h=2,f=a.length,u=new Array(f),c=Math.round((a[0]-o)/i),d=Math.round((a[1]-s)/r);for(u[0]=c-t,t=c,u[1]=d-n,n=d;h<f;)u[h]=a[h],++h;return u}}function Xn(e,t){for(var n,i=e.length,r=i-t;r<--i;)n=e[r],e[r++]=e[i],e[i]=n}function Xr(e,t){return typeof t=="string"&&(t=e.objects[t]),t.type==="GeometryCollection"?{type:"FeatureCollection",features:t.geometries.map(function(n){return $n(e,n)})}:$n(e,t)}function $n(e,t){var n=t.id,i=t.bbox,r=t.properties==null?{}:t.properties,o=Zt(e,t);let s=n==null&&i==null?{type:"Feature",properties:r,geometry:o}:i==null?{type:"Feature",id:n,properties:r,geometry:o}:{type:"Feature",id:n,bbox:i,properties:r,geometry:o};return Object.keys(r).length===0&&delete s.properties,s}function Zt(e,t){let n=Wn(e.transform),i=e.arcs;function r(f,u){u.length&&u.pop();for(var c=i[f<0?~f:f],d=0,g=c.length;d<g;++d)u.push(n(c[d],d));f<0&&Xn(u,g)}function o(f){return n(f)}function s(f){for(var u=[],c=0,d=f.length;c<d;++c)r(f[c],u);return u.length<2&&u.push(u[0]),u}function a(f){for(var u=s(f);u.length<4;)u.push(u[0]);return u}function l(f){return f.map(a)}function h(f){var u=f.type,c;switch(u){case"GeometryCollection":return{type:u,geometries:f.geometries.map(h)};case"Point":c=o(f.coordinates);break;case"MultiPoint":c=f.coordinates.map(o);break;case"LineString":c=s(f.arcs);break;case"MultiLineString":c=f.arcs.map(s);break;case"Polygon":c=l(f.arcs);break;case"MultiPolygon":c=f.arcs.map(l);break;default:return null}return{type:u,coordinates:c}}return h(t)}function $r(e){var t={},n=e.map(function(){return[]});function i(g,M){g.forEach(function(A){A<0&&(A=~A);var p=t[A];p?p.push(M):t[A]=[M]})}function r(g,M){g.forEach(function(A){i(A,M)})}function o(g,M){g.type==="GeometryCollection"?g.geometries.forEach(function(A){o(A,M)}):g.type in s&&s[g.type](g.arcs,M)}const s={LineString:i,MultiLineString:r,Polygon:r,MultiPolygon:function(g,M){g.forEach(function(A){r(A,M)})}};e.forEach(o);for(let g in t)for(var a=t[g],l=a.length,h=0;h<l;++h)for(var f=h+1;f<l;++f){var u=a[h],c=a[f],d;(d=n[u])[g=Yn(d,c)]!==c&&d.splice(g,0,c),(d=n[c])[g=Yn(d,u)]!==u&&d.splice(g,0,u)}return n}function zn(e,t){var n={},i={},r={},o=[],s=-1;t.forEach(function(h,f){if(e.arcs)var u=e.arcs[h<0?~h:h],c;u.length<3&&!u[1][0]&&!u[1][1]&&(c=t[++s],t[s]=h,t[f]=c)}),t.forEach(function(h){var f=a(h),u=f[0],c=f[1],d,g;if(d=r[u])if(delete r[d.end],d.push(h),d.end=c,g=i[c]){delete i[g.start];var M=g===d?d:d.concat(g);i[M.start=d.start]=r[M.end=g.end]=M}else i[d.start]=r[d.end]=d;else if(d=i[c])if(delete i[d.start],d.unshift(h),d.start=u,g=r[u]){delete r[g.end];var A=g===d?d:g.concat(d);i[A.start=g.start]=r[A.end=d.end]=A}else i[d.start]=r[d.end]=d;else d=[h],i[d.start=u]=r[d.end=c]=d});function a(h){if(e.arcs){let f=e.arcs[h<0?~h:h],u=f[0],c;return e.transform?(c=[0,0],f.forEach(function(d){c[0]+=d[0],c[1]+=d[1]})):c=f[f.length-1],h<0?[c,u]:[u,c]}}function l(h,f){for(var u in h){var c=h[u];delete f[c.start],delete c.start,delete c.end,c.forEach(function(d){n[d<0?~d:d]=1}),o.push(c)}}return l(r,i),l(i,r),t.forEach(function(h){n[h<0?~h:h]||o.push([h])}),o}function zr(e){return Zt(e,Un.apply(this,arguments))}function Un(e,t,n){var i,r,o;if(arguments.length>1)i=Ur(e,t,n);else for(r=0,i=new Array(o=e.arcs.length);r<o;++r)i[r]=r;return{type:"MultiLineString",arcs:zn(e,i)}}function Ur(e,t,n){var i=[],r=[],o;function s(u){var c=u<0?~u:u;(r[c]||(r[c]=[])).push({i:u,g:o})}function a(u){u.forEach(s)}function l(u){u.forEach(a)}function h(u){u.forEach(l)}function f(u){switch(o=u,u.type){case"GeometryCollection":u.geometries.forEach(f);break;case"LineString":a(u.arcs);break;case"MultiLineString":case"Polygon":l(u.arcs);break;case"MultiPolygon":h(u.arcs);break}}return f(t),r.forEach(n==null?function(u){i.push(u[0].i)}:function(u){n(u[0].g,u[u.length-1].g)&&i.push(u[0].i)}),i}function Vr(e){for(var t=-1,n=e.length,i,r=e[n-1],o=0;++t<n;)i=r,r=e[t],o+=i[0]*r[1]-i[1]*r[0];return Math.abs(o)}function Hr(e){return Zt(e,Vn.apply(this,arguments))}function Vn(e,t){var n={},i=[],r=[];t.forEach(o);function o(l){switch(l.type){case"GeometryCollection":l.geometries.forEach(o);break;case"Polygon":s(l.arcs);break;case"MultiPolygon":l.arcs.forEach(s);break}}function s(l){l.forEach(function(h){h.forEach(function(f){(n[f=f<0?~f:f]||(n[f]=[])).push(l)})}),i.push(l)}function a(l){return Vr(Zt(e,{type:"Polygon",arcs:[l]}).coordinates[0])}return i.forEach(function(l){if(!l._){var h=[],f=[l];for(l._=1,r.push(h);l=f.pop();)h.push(l),l.forEach(function(u){u.forEach(function(c){n[c<0?~c:c].forEach(function(d){d._||(d._=1,f.push(d))})})})}}),i.forEach(function(l){delete l._}),{type:"MultiPolygon",arcs:r.map(function(l){let h=[],f;if(l.forEach(function(M){M.forEach(function(A){A.forEach(function(p){n[p<0?~p:p].length<2&&h.push(p)})})}),h=zn(e,h),(f=h.length)>1)for(var u=1,c=a(h[0]),d,g;u<f;++u)(d=a(h[u]))>c&&(g=h[0],h[0]=h[u],h[u]=g,c=d);return h}).filter(function(l){return l.length>0})}}const me=6378137,vt=20037508342789244e-9,Jr=85.05112877980659,At={project(e){let t=Math.PI/180,n=Jr,i=Math.max(Math.min(n,e[1]),-n),r=Math.sin(i*t),o=me*e[0]*t,s=me*Math.log((1+r)/(1-r))/2;return s>vt&&(s=vt),s<-vt&&(s=-vt),o>vt&&(o=vt),o<-vt&&(o=-vt),[o,s]},unproject(e){let t=180/Math.PI;return[e[0]*t/me,(2*Math.atan(Math.exp(e[1]/me))-Math.PI/2)*t]},bounds:[-vt,-vt,vt,vt],name:"EPSG:3857"};function Hn(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.max(e[2],t[2]),Math.max(e[3],t[3])]}function Kr(e,t){return[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.max(e[2],t[0]),Math.max(e[3],t[1])]}function Qr(e,t=At){let n,i=t.project([e[0],e[1]]),r=t.project([e[2],e[3]]);return n=[i[0],i[1],r[0],r[1]],n}function Zr(e,t=At){let n,i=t.unproject([e[0],e[1]]),r=t.unproject([e[2],e[3]]);return n=[i[0],i[1],r[0],r[1]],n}function Ne(e){let t=1/0,n=1/0,i=-1/0,r=-1/0;for(let o=0;o<e.length;o++){let s=e[o][0],a=e[o][1];t=Math.min(t,s),n=Math.min(n,a),i=Math.max(i,s),r=Math.max(r,a)}return[t,n,i,r]}function ge(e,t){let n=t[0],i=t[1],r=t[2],o=t[3],s=e[0],a=e[1];return s>=n&&s<=r&&a>=i&&a<=o}function to(e,t){return e[0]<=t[0]&&e[1]<=t[1]&&e[2]>=t[2]&&e[3]>=t[3]}function Jn(e,t){return e[0]<=t[2]&&e[2]>=t[0]&&e[1]<=t[3]&&e[3]>=t[1]}function eo(e,t){return e[0]<t[2]&&e[2]>t[0]&&e[1]<t[3]&&e[3]>t[1]}function no(e,t){return e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]}function io(e,t){let n=t.map((r,o)=>o%2===0?Zn(r):r),i=t.map((r,o)=>o%2===0?Ye(r):r);return ge(e,n)||ge(e,i)}function ro(e){let t=e.map(ao),n=Ne(e),i=Ne(t);return lo(n,i,[!1,!0])}function oo(e){let t=[e[0],e[1],180,e[3]],n=[-180,e[1],e[2],e[3]];return[t,n]}function Kn(e){return{x:(e[0]+e[2])/2,y:(e[1]+e[3])/2,w:e[2]-e[0],h:e[3]-e[1]}}function so(e){return[e.x-e.w/2,e.y-e.h/2,e.x+e.w/2,e.y+e.h/2]}function Qn(e){let t=e[0],n=e[1],i=e[2],r=e[3];return[[t,n],[t,r],[i,r],[i,n],[t,n]]}function Zn(e){return e<0?e+180:e-180}function Ye(e){return e<0?e+180:e-180}function ao(e){return[Zn(e[0]),e[1]]}function lo(e,t,n=[!1,!1]){let i=e[2]-e[0],r=e[3]-e[1],o=t[2]-t[0],s=t[3]-t[1];return i*r<o*s?n[0]?e.map((a,l)=>l%2===0?Ye(a):a):e:n[1]?t.map((a,l)=>l%2===0?Ye(a):a):t}const yt=11102230246251565e-32,B=134217729,ti=(3+8*yt)*yt;function ht(e,t,n,i,r){let o,s,a,l,h=t[0],f=i[0],u=0,c=0;f>h==f>-h?(o=h,h=t[++u]):(o=f,f=i[++c]);let d=0;if(u<e&&c<n)for(f>h==f>-h?(s=h+o,a=o-(s-h),h=t[++u]):(s=f+o,a=o-(s-f),f=i[++c]),o=s,a!==0&&(r[d++]=a);u<e&&c<n;)f>h==f>-h?(s=o+h,l=s-o,a=o-(s-l)+(h-l),h=t[++u]):(s=o+f,l=s-o,a=o-(s-l)+(f-l),f=i[++c]),o=s,a!==0&&(r[d++]=a);for(;u<e;)s=o+h,l=s-o,a=o-(s-l)+(h-l),h=t[++u],o=s,a!==0&&(r[d++]=a);for(;c<n;)s=o+f,l=s-o,a=o-(s-l)+(f-l),f=i[++c],o=s,a!==0&&(r[d++]=a);return(o!==0||d===0)&&(r[d++]=o),d}function pt(e,t,n,i,r,o,s,a){return ht(ht(e,t,n,i,s),s,r,o,a)}function x(e,t,n,i){let r,o,s,a,l,h,f,u,c,d,g;f=B*n,d=f-(f-n),g=n-d;let M=t[0];r=M*n,f=B*M,u=f-(f-M),c=M-u,s=c*g-(r-u*d-c*d-u*g);let A=0;s!==0&&(i[A++]=s);for(let p=1;p<e;p++)M=t[p],a=M*n,f=B*M,u=f-(f-M),c=M-u,l=c*g-(a-u*d-c*d-u*g),o=r+l,h=o-r,s=r-(o-h)+(l-h),s!==0&&(i[A++]=s),r=a+o,s=o-(r-a),s!==0&&(i[A++]=s);return(r!==0||A===0)&&(i[A++]=r),A}function ei(e,t){let n=t[0];for(let i=1;i<e;i++)n+=t[i];return n}function et(e){return new Float64Array(e)}const uo=(3+16*yt)*yt,ho=(2+12*yt)*yt,fo=(9+64*yt)*yt*yt,Yt=et(4),ni=et(8),ii=et(12),ri=et(16),mt=et(4);function co(e,t,n,i,r,o,s){let a,l,h,f,u,c,d,g,M,A,p,E,G,L,F,j,Y,X;const I=e-r,W=n-r,R=t-o,z=i-o;L=I*z,c=B*I,d=c-(c-I),g=I-d,c=B*z,M=c-(c-z),A=z-M,F=g*A-(L-d*M-g*M-d*A),j=R*W,c=B*R,d=c-(c-R),g=R-d,c=B*W,M=c-(c-W),A=W-M,Y=g*A-(j-d*M-g*M-d*A),p=F-Y,u=F-p,Yt[0]=F-(p+u)+(u-Y),E=L+p,u=E-L,G=L-(E-u)+(p-u),p=G-j,u=G-p,Yt[1]=G-(p+u)+(u-j),X=E+p,u=X-E,Yt[2]=E-(X-u)+(p-u),Yt[3]=X;let U=ei(4,Yt),y=ho*s;if(U>=y||-U>=y||(u=e-I,a=e-(I+u)+(u-r),u=n-W,h=n-(W+u)+(u-r),u=t-R,l=t-(R+u)+(u-o),u=i-z,f=i-(z+u)+(u-o),a===0&&l===0&&h===0&&f===0)||(y=fo*s+ti*Math.abs(U),U+=I*f+z*a-(R*h+W*l),U>=y||-U>=y))return U;L=a*z,c=B*a,d=c-(c-a),g=a-d,c=B*z,M=c-(c-z),A=z-M,F=g*A-(L-d*M-g*M-d*A),j=l*W,c=B*l,d=c-(c-l),g=l-d,c=B*W,M=c-(c-W),A=W-M,Y=g*A-(j-d*M-g*M-d*A),p=F-Y,u=F-p,mt[0]=F-(p+u)+(u-Y),E=L+p,u=E-L,G=L-(E-u)+(p-u),p=G-j,u=G-p,mt[1]=G-(p+u)+(u-j),X=E+p,u=X-E,mt[2]=E-(X-u)+(p-u),mt[3]=X;const w=ht(4,Yt,4,mt,ni);L=I*f,c=B*I,d=c-(c-I),g=I-d,c=B*f,M=c-(c-f),A=f-M,F=g*A-(L-d*M-g*M-d*A),j=R*h,c=B*R,d=c-(c-R),g=R-d,c=B*h,M=c-(c-h),A=h-M,Y=g*A-(j-d*M-g*M-d*A),p=F-Y,u=F-p,mt[0]=F-(p+u)+(u-Y),E=L+p,u=E-L,G=L-(E-u)+(p-u),p=G-j,u=G-p,mt[1]=G-(p+u)+(u-j),X=E+p,u=X-E,mt[2]=E-(X-u)+(p-u),mt[3]=X;const b=ht(w,ni,4,mt,ii);L=a*f,c=B*a,d=c-(c-a),g=a-d,c=B*f,M=c-(c-f),A=f-M,F=g*A-(L-d*M-g*M-d*A),j=l*h,c=B*l,d=c-(c-l),g=l-d,c=B*h,M=c-(c-h),A=h-M,Y=g*A-(j-d*M-g*M-d*A),p=F-Y,u=F-p,mt[0]=F-(p+u)+(u-Y),E=L+p,u=E-L,G=L-(E-u)+(p-u),p=G-j,u=G-p,mt[1]=G-(p+u)+(u-j),X=E+p,u=X-E,mt[2]=E-(X-u)+(p-u),mt[3]=X;const P=ht(b,ii,4,mt,ri);return ri[P-1]}function te(e,t,n,i,r,o){const s=(t-o)*(n-r),a=(e-r)*(i-o),l=s-a,h=Math.abs(s+a);return Math.abs(l)>=uo*h?l:-co(e,t,n,i,r,o,h)}const yo=(10+96*yt)*yt,mo=(4+48*yt)*yt,go=(44+576*yt)*yt*yt,Ct=et(4),Ft=et(4),kt=et(4),Tt=et(4),xt=et(4),St=et(4),gt=et(4),wt=et(4),We=et(8),Xe=et(8),$e=et(8),ze=et(8),Ue=et(8),Ve=et(8),we=et(8),Me=et(8),be=et(8),_t=et(4),jt=et(4),Rt=et(4),_=et(8),$=et(16),ot=et(16),st=et(16),nt=et(32),Bt=et(32),at=et(48),Mt=et(64);let Wt=et(1152),He=et(1152);function lt(e,t,n){e=ht(e,Wt,t,n,He);const i=Wt;return Wt=He,He=i,e}function wo(e,t,n,i,r,o,s,a,l){let h,f,u,c,d,g,M,A,p,E,G,L,F,j,Y,X,I,W,R,z,U,y,w,b,P,T,C,v,S,O,k,q,D,V,N;const J=e-s,K=n-s,Q=r-s,it=t-a,Z=i-a,rt=o-a;k=K*rt,w=B*K,b=w-(w-K),P=K-b,w=B*rt,T=w-(w-rt),C=rt-T,q=P*C-(k-b*T-P*T-b*C),D=Q*Z,w=B*Q,b=w-(w-Q),P=Q-b,w=B*Z,T=w-(w-Z),C=Z-T,V=P*C-(D-b*T-P*T-b*C),v=q-V,y=q-v,Ct[0]=q-(v+y)+(y-V),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O-D,y=O-v,Ct[1]=O-(v+y)+(y-D),N=S+v,y=N-S,Ct[2]=S-(N-y)+(v-y),Ct[3]=N,k=Q*it,w=B*Q,b=w-(w-Q),P=Q-b,w=B*it,T=w-(w-it),C=it-T,q=P*C-(k-b*T-P*T-b*C),D=J*rt,w=B*J,b=w-(w-J),P=J-b,w=B*rt,T=w-(w-rt),C=rt-T,V=P*C-(D-b*T-P*T-b*C),v=q-V,y=q-v,Ft[0]=q-(v+y)+(y-V),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O-D,y=O-v,Ft[1]=O-(v+y)+(y-D),N=S+v,y=N-S,Ft[2]=S-(N-y)+(v-y),Ft[3]=N,k=J*Z,w=B*J,b=w-(w-J),P=J-b,w=B*Z,T=w-(w-Z),C=Z-T,q=P*C-(k-b*T-P*T-b*C),D=K*it,w=B*K,b=w-(w-K),P=K-b,w=B*it,T=w-(w-it),C=it-T,V=P*C-(D-b*T-P*T-b*C),v=q-V,y=q-v,kt[0]=q-(v+y)+(y-V),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O-D,y=O-v,kt[1]=O-(v+y)+(y-D),N=S+v,y=N-S,kt[2]=S-(N-y)+(v-y),kt[3]=N,h=ht(ht(ht(x(x(4,Ct,J,_),_,J,$),$,x(x(4,Ct,it,_),_,it,ot),ot,nt),nt,ht(x(x(4,Ft,K,_),_,K,$),$,x(x(4,Ft,Z,_),_,Z,ot),ot,Bt),Bt,Mt),Mt,ht(x(x(4,kt,Q,_),_,Q,$),$,x(x(4,kt,rt,_),_,rt,ot),ot,nt),nt,Wt);let It=ei(h,Wt),se=mo*l;if(It>=se||-It>=se||(y=e-J,f=e-(J+y)+(y-s),y=t-it,d=t-(it+y)+(y-a),y=n-K,u=n-(K+y)+(y-s),y=i-Z,g=i-(Z+y)+(y-a),y=r-Q,c=r-(Q+y)+(y-s),y=o-rt,M=o-(rt+y)+(y-a),f===0&&u===0&&c===0&&d===0&&g===0&&M===0)||(se=go*l+ti*Math.abs(It),It+=(J*J+it*it)*(K*M+rt*u-(Z*c+Q*g))+2*(J*f+it*d)*(K*rt-Z*Q)+((K*K+Z*Z)*(Q*d+it*c-(rt*f+J*M))+2*(K*u+Z*g)*(Q*it-rt*J))+((Q*Q+rt*rt)*(J*g+Z*f-(it*u+K*d))+2*(Q*c+rt*M)*(J*Z-it*K)),It>=se||-It>=se))return It;if((u!==0||g!==0||c!==0||M!==0)&&(k=J*J,w=B*J,b=w-(w-J),P=J-b,q=P*P-(k-b*b-(b+b)*P),D=it*it,w=B*it,b=w-(w-it),P=it-b,V=P*P-(D-b*b-(b+b)*P),v=q+V,y=v-q,Tt[0]=q-(v-y)+(V-y),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O+D,y=v-O,Tt[1]=O-(v-y)+(D-y),N=S+v,y=N-S,Tt[2]=S-(N-y)+(v-y),Tt[3]=N),(c!==0||M!==0||f!==0||d!==0)&&(k=K*K,w=B*K,b=w-(w-K),P=K-b,q=P*P-(k-b*b-(b+b)*P),D=Z*Z,w=B*Z,b=w-(w-Z),P=Z-b,V=P*P-(D-b*b-(b+b)*P),v=q+V,y=v-q,xt[0]=q-(v-y)+(V-y),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O+D,y=v-O,xt[1]=O-(v-y)+(D-y),N=S+v,y=N-S,xt[2]=S-(N-y)+(v-y),xt[3]=N),(f!==0||d!==0||u!==0||g!==0)&&(k=Q*Q,w=B*Q,b=w-(w-Q),P=Q-b,q=P*P-(k-b*b-(b+b)*P),D=rt*rt,w=B*rt,b=w-(w-rt),P=rt-b,V=P*P-(D-b*b-(b+b)*P),v=q+V,y=v-q,St[0]=q-(v-y)+(V-y),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O+D,y=v-O,St[1]=O-(v-y)+(D-y),N=S+v,y=N-S,St[2]=S-(N-y)+(v-y),St[3]=N),f!==0&&(A=x(4,Ct,f,We),h=lt(h,pt(x(A,We,2*J,$),$,x(x(4,St,f,_),_,Z,ot),ot,x(x(4,xt,f,_),_,-rt,st),st,nt,at),at)),d!==0&&(p=x(4,Ct,d,Xe),h=lt(h,pt(x(p,Xe,2*it,$),$,x(x(4,xt,d,_),_,Q,ot),ot,x(x(4,St,d,_),_,-K,st),st,nt,at),at)),u!==0&&(E=x(4,Ft,u,$e),h=lt(h,pt(x(E,$e,2*K,$),$,x(x(4,Tt,u,_),_,rt,ot),ot,x(x(4,St,u,_),_,-it,st),st,nt,at),at)),g!==0&&(G=x(4,Ft,g,ze),h=lt(h,pt(x(G,ze,2*Z,$),$,x(x(4,St,g,_),_,J,ot),ot,x(x(4,Tt,g,_),_,-Q,st),st,nt,at),at)),c!==0&&(L=x(4,kt,c,Ue),h=lt(h,pt(x(L,Ue,2*Q,$),$,x(x(4,xt,c,_),_,it,ot),ot,x(x(4,Tt,c,_),_,-Z,st),st,nt,at),at)),M!==0&&(F=x(4,kt,M,Ve),h=lt(h,pt(x(F,Ve,2*rt,$),$,x(x(4,Tt,M,_),_,K,ot),ot,x(x(4,xt,M,_),_,-J,st),st,nt,at),at)),f!==0||d!==0){if(u!==0||g!==0||c!==0||M!==0?(k=u*rt,w=B*u,b=w-(w-u),P=u-b,w=B*rt,T=w-(w-rt),C=rt-T,q=P*C-(k-b*T-P*T-b*C),D=K*M,w=B*K,b=w-(w-K),P=K-b,w=B*M,T=w-(w-M),C=M-T,V=P*C-(D-b*T-P*T-b*C),v=q+V,y=v-q,gt[0]=q-(v-y)+(V-y),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O+D,y=v-O,gt[1]=O-(v-y)+(D-y),N=S+v,y=N-S,gt[2]=S-(N-y)+(v-y),gt[3]=N,k=c*-Z,w=B*c,b=w-(w-c),P=c-b,w=B*-Z,T=w-(w- -Z),C=-Z-T,q=P*C-(k-b*T-P*T-b*C),D=Q*-g,w=B*Q,b=w-(w-Q),P=Q-b,w=B*-g,T=w-(w- -g),C=-g-T,V=P*C-(D-b*T-P*T-b*C),v=q+V,y=v-q,wt[0]=q-(v-y)+(V-y),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O+D,y=v-O,wt[1]=O-(v-y)+(D-y),N=S+v,y=N-S,wt[2]=S-(N-y)+(v-y),wt[3]=N,Y=ht(4,gt,4,wt,Me),k=u*M,w=B*u,b=w-(w-u),P=u-b,w=B*M,T=w-(w-M),C=M-T,q=P*C-(k-b*T-P*T-b*C),D=c*g,w=B*c,b=w-(w-c),P=c-b,w=B*g,T=w-(w-g),C=g-T,V=P*C-(D-b*T-P*T-b*C),v=q-V,y=q-v,jt[0]=q-(v+y)+(y-V),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O-D,y=O-v,jt[1]=O-(v+y)+(y-D),N=S+v,y=N-S,jt[2]=S-(N-y)+(v-y),jt[3]=N,W=4):(Me[0]=0,Y=1,jt[0]=0,W=1),f!==0){const ft=x(Y,Me,f,st);h=lt(h,ht(x(A,We,f,$),$,x(ft,st,2*J,nt),nt,at),at);const ct=x(W,jt,f,_);h=lt(h,pt(x(ct,_,2*J,$),$,x(ct,_,f,ot),ot,x(ft,st,f,nt),nt,Bt,Mt),Mt),g!==0&&(h=lt(h,x(x(4,St,f,_),_,g,$),$)),M!==0&&(h=lt(h,x(x(4,xt,-f,_),_,M,$),$))}if(d!==0){const ft=x(Y,Me,d,st);h=lt(h,ht(x(p,Xe,d,$),$,x(ft,st,2*it,nt),nt,at),at);const ct=x(W,jt,d,_);h=lt(h,pt(x(ct,_,2*it,$),$,x(ct,_,d,ot),ot,x(ft,st,d,nt),nt,Bt,Mt),Mt)}}if(u!==0||g!==0){if(c!==0||M!==0||f!==0||d!==0?(k=c*it,w=B*c,b=w-(w-c),P=c-b,w=B*it,T=w-(w-it),C=it-T,q=P*C-(k-b*T-P*T-b*C),D=Q*d,w=B*Q,b=w-(w-Q),P=Q-b,w=B*d,T=w-(w-d),C=d-T,V=P*C-(D-b*T-P*T-b*C),v=q+V,y=v-q,gt[0]=q-(v-y)+(V-y),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O+D,y=v-O,gt[1]=O-(v-y)+(D-y),N=S+v,y=N-S,gt[2]=S-(N-y)+(v-y),gt[3]=N,z=-rt,U=-M,k=f*z,w=B*f,b=w-(w-f),P=f-b,w=B*z,T=w-(w-z),C=z-T,q=P*C-(k-b*T-P*T-b*C),D=J*U,w=B*J,b=w-(w-J),P=J-b,w=B*U,T=w-(w-U),C=U-T,V=P*C-(D-b*T-P*T-b*C),v=q+V,y=v-q,wt[0]=q-(v-y)+(V-y),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O+D,y=v-O,wt[1]=O-(v-y)+(D-y),N=S+v,y=N-S,wt[2]=S-(N-y)+(v-y),wt[3]=N,X=ht(4,gt,4,wt,be),k=c*d,w=B*c,b=w-(w-c),P=c-b,w=B*d,T=w-(w-d),C=d-T,q=P*C-(k-b*T-P*T-b*C),D=f*M,w=B*f,b=w-(w-f),P=f-b,w=B*M,T=w-(w-M),C=M-T,V=P*C-(D-b*T-P*T-b*C),v=q-V,y=q-v,Rt[0]=q-(v+y)+(y-V),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O-D,y=O-v,Rt[1]=O-(v+y)+(y-D),N=S+v,y=N-S,Rt[2]=S-(N-y)+(v-y),Rt[3]=N,R=4):(be[0]=0,X=1,Rt[0]=0,R=1),u!==0){const ft=x(X,be,u,st);h=lt(h,ht(x(E,$e,u,$),$,x(ft,st,2*K,nt),nt,at),at);const ct=x(R,Rt,u,_);h=lt(h,pt(x(ct,_,2*K,$),$,x(ct,_,u,ot),ot,x(ft,st,u,nt),nt,Bt,Mt),Mt),M!==0&&(h=lt(h,x(x(4,Tt,u,_),_,M,$),$)),d!==0&&(h=lt(h,x(x(4,St,-u,_),_,d,$),$))}if(g!==0){const ft=x(X,be,g,st);h=lt(h,ht(x(G,ze,g,$),$,x(ft,st,2*Z,nt),nt,at),at);const ct=x(R,Rt,g,_);h=lt(h,pt(x(ct,_,2*Z,$),$,x(ct,_,g,ot),ot,x(ft,st,g,nt),nt,Bt,Mt),Mt)}}if(c!==0||M!==0){if(f!==0||d!==0||u!==0||g!==0?(k=f*Z,w=B*f,b=w-(w-f),P=f-b,w=B*Z,T=w-(w-Z),C=Z-T,q=P*C-(k-b*T-P*T-b*C),D=J*g,w=B*J,b=w-(w-J),P=J-b,w=B*g,T=w-(w-g),C=g-T,V=P*C-(D-b*T-P*T-b*C),v=q+V,y=v-q,gt[0]=q-(v-y)+(V-y),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O+D,y=v-O,gt[1]=O-(v-y)+(D-y),N=S+v,y=N-S,gt[2]=S-(N-y)+(v-y),gt[3]=N,z=-it,U=-d,k=u*z,w=B*u,b=w-(w-u),P=u-b,w=B*z,T=w-(w-z),C=z-T,q=P*C-(k-b*T-P*T-b*C),D=K*U,w=B*K,b=w-(w-K),P=K-b,w=B*U,T=w-(w-U),C=U-T,V=P*C-(D-b*T-P*T-b*C),v=q+V,y=v-q,wt[0]=q-(v-y)+(V-y),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O+D,y=v-O,wt[1]=O-(v-y)+(D-y),N=S+v,y=N-S,wt[2]=S-(N-y)+(v-y),wt[3]=N,j=ht(4,gt,4,wt,we),k=f*g,w=B*f,b=w-(w-f),P=f-b,w=B*g,T=w-(w-g),C=g-T,q=P*C-(k-b*T-P*T-b*C),D=u*d,w=B*u,b=w-(w-u),P=u-b,w=B*d,T=w-(w-d),C=d-T,V=P*C-(D-b*T-P*T-b*C),v=q-V,y=q-v,_t[0]=q-(v+y)+(y-V),S=k+v,y=S-k,O=k-(S-y)+(v-y),v=O-D,y=O-v,_t[1]=O-(v+y)+(y-D),N=S+v,y=N-S,_t[2]=S-(N-y)+(v-y),_t[3]=N,I=4):(we[0]=0,j=1,_t[0]=0,I=1),c!==0){const ft=x(j,we,c,st);h=lt(h,ht(x(L,Ue,c,$),$,x(ft,st,2*Q,nt),nt,at),at);const ct=x(I,_t,c,_);h=lt(h,pt(x(ct,_,2*Q,$),$,x(ct,_,c,ot),ot,x(ft,st,c,nt),nt,Bt,Mt),Mt),d!==0&&(h=lt(h,x(x(4,xt,c,_),_,d,$),$)),g!==0&&(h=lt(h,x(x(4,Tt,-c,_),_,g,$),$))}if(M!==0){const ft=x(j,we,M,st);h=lt(h,ht(x(F,Ve,M,$),$,x(ft,st,2*rt,nt),nt,at),at);const ct=x(I,_t,M,_);h=lt(h,pt(x(ct,_,2*rt,$),$,x(ct,_,M,ot),ot,x(ft,st,M,nt),nt,Bt,Mt),Mt)}}return Wt[h-1]}function Mo(e,t,n,i,r,o,s,a){const l=e-s,h=n-s,f=r-s,u=t-a,c=i-a,d=o-a,g=h*d,M=f*c,A=l*l+u*u,p=f*u,E=l*d,G=h*h+c*c,L=l*c,F=h*u,j=f*f+d*d,Y=A*(g-M)+G*(p-E)+j*(L-F),X=(Math.abs(g)+Math.abs(M))*A+(Math.abs(p)+Math.abs(E))*G+(Math.abs(L)+Math.abs(F))*j,I=yo*X;return Y>I||-Y>I?Y:wo(e,t,n,i,r,o,s,a,X)}const ee=At.project,oi=At.unproject;function Je(e,t,n,i,r=At.project,o=At.unproject,s=!1){r&&(e=r(e),t=r(t),n=r(n),i=r(i));let a=[t[0]-e[0],t[1]-e[1]],l=[i[0]-n[0],i[1]-n[1]],h=Gt(a,l);if(h===0)return console.log("两条线段平行或共线"),null;let f=Gt([n[0]-e[0],n[1]-e[1]],l)/h,u=Gt([n[0]-e[0],n[1]-e[1]],a)/h;return!s&&(f<0||f>1||u<0||u>1)?(console.log("交点不在两条线段上"),null):o?o([e[0]+a[0]*f,e[1]+a[1]*f]):[e[0]+a[0]*f,e[1]+a[1]*f]}function si(e,t,n=!1){if(n){let i=ee(e),r=t[0],o=t[1],s=t[2],a=t[3];return[r,o]=ee([r,o]),[s,a]=ee([s,a]),i[0]<r||i[0]>s||i[1]<o||i[1]>a}else{let i=t[0],r=t[1],o=t[2],s=t[3];return e[0]<i||e[0]>o||e[1]<r||e[1]>s}}function ai(e,t){return li(e,Qn(t))}function li(e,t){let n=e[e.length-1],i,r,o,s=t;for(let a in e){i=e[a];let l=s;s=[],r=l[l.length-1];for(let h in l){if(o=l[h],ve(o,n,i)){if(!ve(r,n,i)){let f=Je(r,o,n,i,ee,oi,!0);s.push(f)}s.push(o)}else if(ve(r,n,i)){let f=Je(r,o,n,i,ee,oi,!0);s.push(f)}r=o}n=i}return s}function bo(e,t){let n=!1;for(let i=0,r=t.length-1;i<t.length;r=i++)t[i][1]>e[1]!=t[r][1]>e[1]&&e[0]<(t[r][0]-t[i][0])*(e[1]-t[i][1])/(t[r][1]-t[i][1])+t[i][0]&&(n=!n);return n}function vo(e){let t=1/0,n=1/0,i=-1/0,r=-1/0;for(let o=0;o<e.length;o++){let s=e[o];s[0]<t&&(t=s[0]),s[0]>i&&(i=s[0]),s[1]<n&&(n=s[1]),s[1]>r&&(r=s[1])}return[t,n,i,r]}function po(e,t){for(let n=0,i=e.length-1;n<e.length;i=n++)t(e[n],e[i])}function Po(e,t){return(e-1+t)%t}function ve(e,t,n){return Ke(t,n,e)>0}function Ao(e){return Math.abs(e)<=180?e:e-Xt(e)*360}function Xt(e){return e<0?-1:e>0?1:0}function Ke(e,t,n){e=Array.isArray(e)?e:e.toXY(),t=Array.isArray(t)?t:t.toXY(),n=Array.isArray(n)?n:n.toXY();let i=e[0],r=e[1],o=t[0],s=t[1],a=n[0],l=n[1],h=(o-i)*(l-r)-(s-r)*(a-i);return h=Xt(h),h}function Qe(e,t){let n=Array.isArray(e)?e:e.toXY(),i=Array.isArray(t)?t:t.toXY(),r=Math.atan2(i[1]-n[1],i[0]-n[0]);return r=r*180/Math.PI,r<0&&(r+=360),r}function Eo(e,t,n,i=!0){e=Array.isArray(e)?e:e.toXY(),t=Array.isArray(t)?t:t.toXY(),n=Array.isArray(n)?n:n.toXY();let r=e[0],o=e[1],s=t[0],a=t[1],l=n[0],h=n[1],f=te(r,o,s,a,l,h);return i&&(f=-f),f=Xt(f),f}function To(e,t,n,i){e=Array.isArray(e)?e:e.toXY(),t=Array.isArray(t)?t:t.toXY(),n=Array.isArray(n)?n:n.toXY(),i=Array.isArray(i)?i:i.toXY();let r=e[0],o=e[1],s=t[0],a=t[1],l=n[0],h=n[1],f=i[0],u=i[1],c=Mo(r,o,s,a,l,h,f,u);return c=Xt(c),c}function xo(e,t,n,i){e=Array.isArray(e)?e:e.toXY(),t=Array.isArray(t)?t:t.toXY(),n=Array.isArray(n)?n:n.toXY(),i=Array.isArray(i)?i:i.toXY();let r=e[0],o=e[1],s=t[0],a=t[1],l=n[0],h=n[1],f=i[0],u=i[1];const c=r-f,d=o-u,g=s-f,M=a-u,A=l-f,p=h-u,E=c*c+d*d,G=g*g+M*M,L=A*A+p*p;let F=c*(M*L-G*p)-d*(g*L-G*A)+E*(g*p-M*A);return Xt(F)}class pe{constructor(t,n){H(this,"MBR");H(this,"data");H(this,"shape");H(this,"rows");H(this,"cols");H(this,"bands");H(this,"stasticsCache",[]);this.MBR=t,this.data=n,this.shape=[n.length,n[0].length,n[0][0].length],[this.bands,this.rows,this.cols]=this.shape}getShape(){return[this.data.length,this.data[0].length,this.data[0][0].length]}getBand(t){return this.data[t]}get width(){return this.cols}get height(){return this.rows}get bandCount(){return this.bands}setMBR(t){this.MBR=t}getXYZValue(t,n=0){let i=t[0],r=t[1];return this.data[n][r][i]}set XYZValue(t){let n=t[0],i=t[1],r=t[2],o=t[3],s=this.data[r][i][n];if(this.data[r][i][n]=o,this.stasticsCache[r]){let a=this.stasticsCache[r].max,l=this.stasticsCache[r].min,h=this.stasticsCache[r].mean,f=this.data[r][i][n];f>a&&(a=f),f<l&&(l=f);let u=h*this.rows*this.cols;u=u-s+f,h=u/(this.rows*this.cols),this.stasticsCache[r]={max:a,min:l,mean:h}}}getSubGrid(t,n=[0]){let i=t[0],r=t[1],o=t[2],s=t[3],a=[];for(let l of n){let h=[];for(let f=i;f<=o;f++){let u=[];for(let c=r;c<=s;c++)u.push(this.data[l][f][c]);h.push(u)}a.push(h)}return a}fillInvalidValue(t){let n=this.data[t],i=0,r=0;for(let s=0;s<this.rows;s++)for(let a=0;a<this.cols;a++){let l=n[s][a];l!==0&&(i+=l,r++)}let o=i/r;for(let s=0;s<this.rows;s++)for(let a=0;a<this.cols;a++){let l=n[s][a];(l===0||l===-9999||l===999999)&&(n[s][a]=o)}}getSubGridObj(t,n=[0]){let i=t[0],r=t[1],o=t[2],s=t[3],a=[];for(let h of n){let f=[];for(let u=i;u<=o;u++){let c=[];for(let d=r;d<=s;d++)c.push(this.data[h][u][d]);f.push(c)}a.push(f)}return new pe(t,a)}ConvertToGridMBR(t){let n=t[0],i=t[1],r=t[2],o=t[3],s=this.getGridCoord([n,i]),a=this.getGridCoord([r,o]);if(s===null||a===null)return null;{let l=s[0],h=s[1],f=a[0],u=a[1];return[l,h,f,u]}}getGridCoord(t){if(si(t,this.MBR))return null;{let n=t[0],i=t[1],r=this.MBR[0],o=this.MBR[1],s=this.MBR[2],a=this.MBR[3],l=Math.floor((i-o)/(a-o)*this.rows),h=Math.floor((n-r)/(s-r)*this.cols);return[l,h]}}getCoordByGridCoord(t){let n=t[0],i=t[1],r=this.MBR[0],o=this.MBR[1],s=this.MBR[2],a=this.MBR[3],l=(i+.5)/this.cols*(s-r)+r,h=(n+.5)/this.rows*(a-o)+o;return[l,h]}getBandStatistics(t){if(!this.stasticsCache[t]){let n=this.data[t],i=n[0][0],r=n[0][0],o=0;for(let a=0;a<this.rows;a++)for(let l=0;l<this.cols;l++){let h=n[a][l];h>i&&(i=h),h<r&&(r=h),o+=h}let s=o/(this.rows*this.cols);this.stasticsCache[t]={max:i,min:r,mean:s}}return this.stasticsCache[t]}binarization(t,n){let i=this.data[t],r=[];for(let o=0;o<this.rows;o++){let s=[];for(let a=0;a<this.cols;a++)i[o][a]<n?s.push(0):s.push(1);r.push(s)}return r}getCoutourCode(t,n){let i=this.binarization(t,n),r=[];for(let o=0;o<this.rows-1;o++){let s=[];for(let a=0;a<this.cols-1;a++){let l=0;l+=i[o][a]*8,l+=i[o][a+1]*4,l+=i[o+1][a+1]*2,l+=i[o+1][a]*1,s.push(l)}r.push(s)}return r}getMean(t){let n=this.data[t],i=0;for(let r=0;r<this.rows;r++)for(let o=0;o<this.cols;o++)i+=n[r][o];return i/(this.rows*this.cols)}getSorted1DArray(t){let n=this.data[t],i=[];for(let r=0;r<this.rows;r++)for(let o=0;o<this.cols;o++)i.push(n[r][o]);return i.sort((r,o)=>r-o),i}static fromFillValue(t=0,n){let i=[];for(let r=0;r<n[0];r++){let o=[];for(let s=0;s<n[1];s++){let a=[];for(let l=0;l<n[2];l++)a.push(t);o.push(a)}i.push(o)}return new pe([0,0,0,0],i)}}function So(e,t,n){let i=e.data[t],r=[];for(let o=0;o<e.rows;o++){let s=[];for(let a=0;a<e.cols;a++)i[o][a]<n?s.push(0):s.push(1);r.push(s)}return r}function Io(e,t){let n=e.rows*e.cols,i=Co(n)+3;(t>i||t<0)&&(t=i);let r=[0,0,e.rows-1,e.cols-1];return ne(r,0,t)}function ne(e,t,n){let i={boundary:e,children:[],depth:t,maxDepth:n,isLeaf:!1,isDivided:!1};if(t===n-1)return i.isLeaf=!0,i;{i.isDivided=!0;let r=e[0],o=e[1],s=e[2],a=e[3],l=(r+s)/2;l=Math.floor(l);let h=(o+a)/2;h=Math.floor(h);let f=[r,h,l,a],u=[l,h,s,a],c=[r,o,l,h],d=[l,o,s,h],g=ne(f,t+1,n),M=ne(u,t+1,n),A=ne(c,t+1,n),p=ne(d,t+1,n);return i.children.push(g),i.children.push(M),i.children.push(A),i.children.push(p),i}}function Co(e){let t=0,n=1;for(;n<e;)n*=4,t++;return t}function Fo(e){let t=-1/0,n=1/0;for(let i=0;i<e.length;i++)for(let r=0;r<e[0].length;r++)e[i][r]>t&&(t=e[i][r]),e[i][r]<n&&(n=e[i][r]);for(let i=0;i<e.length;i++)for(let r=0;r<e[0].length;r++)(e[i][r]===t||e[i][r]===n)&&(e[i][r]=0)}const ko=Math.E;function Ze(e,t,n){return(t-e)*(3-n*2)*n*n+e}function Bo(e,t){let r=e,o=t;r*=3284157443,o^=r<<128|r>>128,o*=1911520717,r^=o<<128|o>>128,r*=2048419325;const s=r*(3.14159265/~(-1>>>1));return{x:Math.cos(s),y:Math.sin(s)}}function Pe(e,t,n,i){const r=Bo(e,t),o=n-e,s=i-t;return o*r.x+s*r.y}function Go(e,t){const n=Math.floor(e),i=n+1,r=Math.floor(t),o=r+1,s=e-n,a=t-r,l=Pe(n,r,e,t),h=Pe(i,r,e,t),f=Ze(l,h,s),u=Pe(n,o,e,t),c=Pe(i,o,e,t),d=Ze(u,c,s);return Ze(f,d,a)}function Lo(e,t){return Math.pow(ko,-Math.pow(Math.sqrt(e*e+t*t),1/2))*Math.sin(Math.sqrt(e*e+t*t))}function _o(e,t){return Math.sin(Math.sqrt(e*e+t*t))}function jo(e,t,n){const i=new Array(e).fill(0).map(()=>new Array(t).fill(0)),r=new Array(n).fill(0).map(()=>({x:Math.random()*e,y:Math.random()*t}));for(let o=0;o<e;o++)for(let s=0;s<t;s++){let a=1e5;for(let l=0;l<n;l++){const h=Math.sqrt(Math.pow(r[l].x-o,2)+Math.pow(r[l].y-s,2));h<a&&(a=h)}i[o][s]=a}return i}function Ro(e,t,n,i="horizontal"){const r=new Array(e).fill(0).map(()=>new Array(t).fill(0)),o=Math.floor(e/n);for(let s=0;s<e;s++)for(let a=0;a<t;a++)i==="vertical"?r[s][a]=Math.floor(s/o)%2===0?1:0:i==="horizontal"?r[s][a]=Math.floor(a/o)%2===0?1:0:i==="diagonal"?r[s][a]=Math.floor((s+a)/o)%2===0?1:0:i==="all"&&(r[s][a]=Math.floor((s+a)/o)%2===0?1:0,r[s][a]+=Math.floor(s/o)%2===0?1:0,r[s][a]+=Math.floor(a/o)%2===0?1:0);return r}class $t{constructor(t,n){H(this,"bbox",[1/0,1/0,-1/0,-1/0]);H(this,"coordinates");H(this,"properties");H(this,"projection",At);this.coordinates=t,n&&(this.properties=n),this.updateBBox()}toXY(){}set Properties(t){this.properties=t}clone(){const t=this.coordinates.slice(),n={...this.properties};return new this.constructor(t,n)}equals(t){return JSON.stringify(this.toGeoJSON())===JSON.stringify(t.toGeoJSON())}toGeoJSON(){let t={type:"Feature",geometry:{type:this.constructor.name,coordinates:this.coordinates}};return this.properties&&(t.properties=this.properties),this.bbox&&(t.bbox=this.bbox),t}static fromGeoJSON(t){if(t.type==="Feature")return this.fromFeature(t);if(t.type==="Geometry")return this.fromGeometry(t);throw t.type==="FeatureCollection"?new Error(t.type+"is not supported"):new Error("Unknown GeoJSON type: "+t.type)}}H($t,"fromFeature"),H($t,"fromGeometry");class Ot{constructor(t,n){H(this,"coordinates");H(this,"geometries",[]);H(this,"bbox",[1/0,1/0,-1/0,-1/0]);H(this,"properties");H(this,"projection",At);n&&(this.properties=n),t.forEach(i=>{this.geometries.push(i),this.updateBBox(i)})}toXY(){}updateBBox(t){const n=t.bbox;n&&(this.bbox=Hn(this.bbox,n))}addGeometry(t){this.geometries.push(t),this.updateBBox(t)}_update(t,n){this.geometries[n]=t,this.updateBBox(t)}toGeoJSON(){let t={type:"Feature",geometry:{type:"GeometryCollection",geometries:this.geometries.map(n=>n.toGeoJSON().geometry)}};return this.properties&&(t.properties=this.properties),this.bbox&&(t.bbox=this.bbox),t}}const tn=Ln;class ut extends $t{get lon(){return this.coordinates[0]}get lat(){return this.coordinates[1]}constructor(t,n){super(t,n)}updateBBox(){this.bbox=[this.coordinates[0],this.coordinates[1],this.coordinates[0],this.coordinates[1]]}toXY(){return this.projection.project(this.coordinates)}static isPoint(t){return t instanceof ut}static fromGeometry(t){return new ut(t.coordinates)}static fromFeature(t){const{geometry:n,properties:i}=t;if(n.type!=="Point")throw new Error(`The input geometry is not a Point: ${n.type}`);const r=n;return i?new ut(r.coordinates,i):new ut(r.coordinates)}}class bt extends Ot{constructor(n,i){var t=(...Bs)=>(super(...Bs),H(this,"coordinates"),this);n[0]instanceof ut?(t(n,i),this.coordinates=n.map(r=>r.coordinates)):(t(n.map(r=>new ut(r)),i),this.coordinates=n)}toXY(){return this.geometries.map(n=>n.toXY())}getCoodinates(){return this.coordinates}centroid(n){if(n){let i=0;for(let l=0;l<n.length;l++)i+=n[l];for(let l=0;l<n.length;l++)n[l]/=i;let r=0,o=0;for(let l=0;l<this.coordinates.length;l++){let h=this.coordinates[l];r+=h[0]*n[l],o+=h[1]*n[l]}let s=r,a=o;return new ut([s,a])}else{let i=0,r=0;for(let a=0;a<this.coordinates.length;a++){let l=this.coordinates[a];i+=l[0],r+=l[1]}let o=i/this.coordinates.length,s=r/this.coordinates.length;return new ut([o,s])}}addGeometry(n){n instanceof ut?(this.geometries.push(n),this.coordinates.push(n.coordinates),this.updateBBox(n)):n instanceof bt?(this.geometries.concat(n.geometries),this.coordinates.concat(n.coordinates),this.updateBBox(n)):(this.geometries.push(new ut(n)),this.coordinates.push(n),this.updateBBox(this.geometries[this.geometries.length-1]))}toGeoJSON(){let n={type:"Feature",geometry:{type:"MultiPoint",coordinates:this.geometries.map(i=>i.coordinates)}};return this.properties&&(n.properties=this.properties),this.bbox&&(n.bbox=this.bbox),n}static isMultiPoint(n){return n instanceof bt}static fromFeature(n){const{geometry:i,properties:r}=n;if(i.type!=="MultiPoint")throw new Error(`The input geometry is not a MultiPoint: ${i.type}`);const o=i;return r?new bt(o.coordinates,r):new bt(o.coordinates)}static fromGeometry(n){return new bt(n.coordinates)}}function Oo(...e){if(e.length===1){if(!tn(e[0])&&e[0].length===2)return new ut(e[0]);if(tn(e[0]))return new ut([e[0].lon||e[0].lng||e[0].x,e[0].lat||e[0].y],e[1]);throw new Error("Invalid input")}else if(e.length===2){if(typeof e[0]=="number"&&typeof e[1]=="number")return new ut([e[0],e[1]]);if(tn(e[0]))return new ut([e[0].lon||e[0].lng||e[0].x,e[0].lat||e[0].y],e[1]);if(Array.isArray(e[0])&&e[0].length===2)return new ut(e[0],e[1]);throw new Error("Invalid input")}else return new ut([e[0],e[1]],e[2])}function qo(e,t){return new bt(e,t)}class Pt extends $t{constructor(t,n){super(t,n)}updateBBox(){let[t,n,i,r]=[1/0,1/0,-1/0,-1/0];for(const[o,s]of this.coordinates)t=Math.min(t,o),n=Math.min(n,s),i=Math.max(i,o),r=Math.max(r,s);this.bbox=[t,n,i,r]}toXY(){return this.coordinates.map(t=>this.projection.project(t))}toMultiPoint(){return new bt(this.coordinates)}static fromGeometry(t){return new Pt(t.coordinates)}static fromFeature(t){const{geometry:n,properties:i}=t;if(n.type!=="LineString")throw new Error(`The input geometry is not a LineString: ${n.type}`);const r=n;return new Pt(r.coordinates,i)}static isLineString(t){return t.type==="LineString"}}class zt extends Ot{constructor(n,i){var t=(...Gs)=>(super(...Gs),H(this,"coordinates"),this);n[0]instanceof Pt?(t(n,i),this.coordinates=n.map(r=>r.coordinates)):(t(n.map(r=>new Pt(r)),i),this.coordinates=n)}getCoodinates(){return this.coordinates}toMultiPoint(){return new bt(this.coordinates.flat())}toXY(){return this.geometries.map(n=>n.toXY())}addGeometry(n){n instanceof Pt?(this.geometries.push(n),this.coordinates.push(n.coordinates),this.updateBBox(n)):(this.geometries.push(new Pt(n)),this.coordinates.push(n),this.updateBBox(this.geometries[this.geometries.length-1]))}toGeoJSON(){let n={type:"Feature",geometry:{type:"MultiLineString",coordinates:this.geometries.map(i=>i.coordinates)}};return this.properties&&(n.properties=this.properties),this.bbox&&(n.bbox=this.bbox),n}static fromFeature(n){const{geometry:i,properties:r}=n;if(i.type!=="MultiLineString")throw new Error(`The input geometry is not a MultiLineString: ${i.type}`);const o=i;return new zt(o.coordinates,r)}static fromGeometry(n){return new zt(n.coordinates)}}function Do(e){return new Pt(e.map(t=>t.coordinates))}class Et extends $t{constructor(t,n){super(t,n)}toXY(){return this.coordinates.map(t=>t.map(n=>this.projection.project(n)))}toMultiPoint(){return new bt(this.coordinates.flat())}updateBBox(){let[t,n,i,r]=[1/0,1/0,-1/0,-1/0];for(const o of this.coordinates)for(const[s,a]of o)t=Math.min(t,s),n=Math.min(n,a),i=Math.max(i,s),r=Math.max(r,a);this.bbox=[t,n,i,r]}static isPolygon(t){return t instanceof Et}static fromGeometry(t){return new Et(t.coordinates)}static fromFeature(t){const{geometry:n,properties:i}=t;if(n.type!=="Polygon")throw new Error(`The input geometry is not a Polygon: ${n.type}`);const r=n;return new Et(r.coordinates,i)}}class Ut extends Ot{constructor(n,i){var t=(...Ls)=>(super(...Ls),H(this,"coordinates"),this);n[0]instanceof Et?(t(n,i),this.coordinates=n.map(r=>r.coordinates)):(t(n.map(r=>new Et(r)),i),this.coordinates=n)}getCoodinates(){return this.coordinates}toMultiPoint(){return new bt(this.coordinates.flat().flat())}toXY(){return this.geometries.map(n=>n.toXY())}addGeometry(n){n instanceof Et?(this.geometries.push(n),this.coordinates.push(n.coordinates),this.updateBBox(n)):(this.geometries.push(new Et(n)),this.coordinates.push(n),this.updateBBox(this.geometries[this.geometries.length-1]))}toGeoJSON(){let n={type:"Feature",geometry:{type:"MultiPolygon",coordinates:this.geometries.map(i=>i.coordinates)}};return this.properties&&(n.properties=this.properties),this.bbox&&(n.bbox=this.bbox),n}static fromFeature(n){const{geometry:i,properties:r}=n;if(i.type!=="MultiPolygon")throw new Error(`The input geometry is not a MultiPolygon: ${i.type}`);const o=i;return new Ut(o.coordinates,r)}static fromGeometry(n){return new Ut(n.coordinates)}}class en{constructor(t,n,i){H(this,"x");H(this,"y");H(this,"r");H(this,"rSquared");this.x=t,this.y=n,this.r=i,this.rSquared=this.r*this.r}contains(t,n=18e8){let i=t[0],r=t[1];return Math.pow(i-this.x,2)+Math.pow(r-this.y,2)-this.rSquared<=n}intersects(t){let n=Kn(t),i=Math.abs(n.x-this.x),r=Math.abs(n.y-this.y),o=this.r,s=n.w/2,a=n.h/2,l=Math.pow(i-s,2)+Math.pow(r-a,2);return i>o+s||r>o+a?!1:i<=s||r<=a?!0:l<=this.rSquared}static isCircle(t){return t instanceof en}}function nn(e){switch(e.type){case"Point":return ut.fromGeometry(e);case"LineString":return Pt.fromGeometry(e);case"Polygon":return Et.fromGeometry(e);case"MultiPoint":return bt.fromGeometry(e);case"MultiLineString":return zt.fromGeometry(e);case"MultiPolygon":return Ut.fromGeometry(e);case"GeometryCollection":return hi(e);default:throw new Error("Unknown geometry type: "+e.type+" in fromGeometryObj")}}function ui(e){if(e.type==="Feature"){const t=e.geometry;switch(t.type){case"Point":return ut.fromFeature(e);case"LineString":return Pt.fromFeature(e);case"Polygon":return Et.fromFeature(e);case"MultiPoint":return bt.fromFeature(e);case"MultiLineString":return zt.fromFeature(e);case"MultiPolygon":return Ut.fromFeature(e);case"GeometryCollection":return rn(e);default:throw new Error("Unknown geometry type: "+t.type+" in fromGeometryObj")}}else{if(e.type==="FeatureCollection")return rn(e);throw new Error("Unknown GeoJSON type")}}function rn(e){if(e.type==="Feature"){const t=e.geometry;if(t.type==="GeometryCollection"){const n=t.geometries.map(i=>nn(i));return new Ot(n,e.properties)}else throw new Error("The input feature is not a GeometryCollection: "+t.type)}else if(e.type==="FeatureCollection"){const t=e.features.map(n=>ui(n));return new Ot(t)}else throw new Error("Unknown GeoJSON type")}function hi(e){if(e.type==="GeometryCollection"){const t=e.geometries.map(n=>nn(n));return new Ot(t)}else throw new Error("The input geometry is not a GeometryCollection: "+e.type)}class Vt{constructor(t,n,i=10){H(this,"capacity");H(this,"boundary");H(this,"points");H(this,"northWest");H(this,"northEast");H(this,"southWest");H(this,"southEast");H(this,"isDivided");H(this,"depth");H(this,"maxDepth",10);this.capacity=n,this.boundary=t,this.points=[],this.isDivided=!1,this.northWest=null,this.northEast=null,this.southWest=null,this.southEast=null,this.depth=0,this.maxDepth=i}contains(t,n){return ge(t,n)}intersects(t,n){return Jn(t,n)}insert(t){return this.contains(t,this.boundary)?this.points.length<this.capacity&&this.depth<this.maxDepth?(this.points.push(t),!0):(this.isDivided||this.subdivide(),this.northEast.insert(t),this.northWest.insert(t),this.southEast.insert(t),this.southWest.insert(t),!0):!1}get pointsList(){return this.points.length===0?null:this.points}subdivide(){let t=this.boundary[0],n=this.boundary[1],i=this.boundary[2]-t,r=this.boundary[3]-n,o=new Vt([t,n+r/2,t+i/2,n+r],this.capacity),s=new Vt([t+i/2,n+r/2,t+i,n+r],this.capacity),a=new Vt([t,n,t+i/2,n+r/2],this.capacity),l=new Vt([t+i/2,n,t+i,n+r/2],this.capacity);this.northWest=o,this.northEast=s,this.southWest=a,this.southEast=l,this.isDivided=!0,this.depth++}queryRange(t){let n=[];if(!this.intersects(this.boundary,t))return n;for(let i=0;i<this.points.length;i++)this.contains(this.points[i],t)&&n.push(this.points[i]);return this.northWest===null||(n.push(...this.northWest.queryRange(t)),n.push(...this.northEast.queryRange(t)),n.push(...this.southWest.queryRange(t)),n.push(...this.southEast.queryRange(t))),n}customQuery(t){let n=[];if(!t.intersects(this.boundary))return n;for(let i=0;i<this.points.length;i++)t.contains(this.points[i])&&n.push(this.points[i]);return this.northWest===null||(n.push(...this.northWest.customQuery(t)),n.push(...this.northEast.customQuery(t)),n.push(...this.southWest.customQuery(t)),n.push(...this.southEast.customQuery(t))),n}}function No(e){return e?/^(epsg:|EPSG:)?3857$/.test(e)||/^(epsg:|EPSG:)?900913$/.test(e)||/^(epsg-|EPSG-)?3857$/.test(e)||/^(epsg-|EPSG-)?900913$/.test(e)||e==="900913"||e==="3857":!1}function Yo(e){return e?/^(epsg:|EPSG:)?4326$/.test(e)||/^(epsg-|EPSG-)?4326$/.test(e)||e==="4326"||e.toLowerCase()==="wgs84":!1}const fi={R:6371e3,projection:null,distance(e,t){return Qt(e,t,this.R)},area(e){return Le(e,this.R)}},ci=85.05112877980659,di=je({},fi,{R:6378137,code:"EPSG:3857",projection:At,wrapLng:[-180,180],wrapLat:[-ci,ci],area(e){return Le(e,this.R)},planeArea(e){return Mn(e,this.R)}}),Wo=je({},di,{code:"EPSG:900913"});class on{constructor(){H(this,"data",[])}push(t){this.data.push(t)}pop(){return this.data.shift()}put(t){this.push(t)}get(){return this.pop()}isEmpty(){return this.data.length===0}}class Ae{constructor(){H(this,"elements",[])}empty(){return this.elements.length===0}put(t,n){this.elements.push([n,t]),this.elements.sort((i,r)=>i[0]-r[0])}get(){var t;return(t=this.elements.shift())==null?void 0:t[1]}isEmpty(){return this.elements.length===0}}function Xo(e,t,n){const i=new Ae;i.put(t,0);let r=new Map,o=new Map;for(r.set(t.join(","),null),o.set(t.join(","),0);!i.isEmpty();){const s=i.get();if(n&&s.join(",")===n.join(","))break;for(const a of e.neighbors(s)){if(e.weights(s,a)===1/0)continue;const l=o.get(s.join(","))+e.weights(s,a);if(!o.has(a.join(","))||l<o.get(a.join(","))){o.set(a.join(","),l);const h=l;i.put(a,h),r.set(a.join(","),s)}}}return r}function $o(e,t){const n=new Ae;n.put(t,0);let i=new Map,r=new Map;for(i.set(t,null),r.set(t,0);!n.isEmpty();){const o=n.get();for(const s of e.neighbors(o)){if(e.weights(o,s)===1/0)continue;const a=r.get(o)+e.weights(o,s);if(!r.has(s)||a<r.get(s)){r.set(s,a);const l=a;n.put(s,l),i.set(s,o)}}}return i}function zo(e,t){const n={nodes:e,edges:new Map,neighbors(i){return n.edges.get(i)||[]}};for(const[i,r,o=1]of t)n.edges.has(i)||n.edges.set(i,[]),n.edges.get(i).push(r),n.edgesWeights||(n.edgesWeights=new Map),n.edgesWeights.has(i)||n.edgesWeights.set(i,new Map),n.edgesWeights.get(i).set(r,o);return n.edgesWeights&&(n.weights=(i,r)=>n.edgesWeights.get(i).get(r)||1/0),n}function Uo(e,t,n=!1){const i=e[0].length,r=e.length,o={grid:e,cols:i,rows:r,neighbors(s){const[a,l]=s;let h=[];return n?h=[[a-1,l-1],[a-1,l+1],[a+1,l-1],[a+1,l+1],[a+1,l],[a,l-1],[a-1,l],[a,l+1]]:h=[[a+1,l],[a-1,l],[a,l-1],[a,l+1]],(a+l)%2===0&&h.reverse(),h.filter(([f,u])=>f>=0&&f<i&&u>=0&&u<r)}};return t&&(o.weights=(s,a)=>t(e[s[1]][s[0]],e[a[1]][a[0]])),o}function Vo(e,t){const n=new on;n.put(t);const i=new Map;for(i.set(t,null);!n.isEmpty();){const r=n.get();for(const o of e.neighbors(r))e.weights(r,o)!==1/0&&(i.has(o)||(n.put(o),i.set(o,r)))}return i}function Ho(e,t,n){const i=new on;i.put(t);let r=new Map;for(r.set(t.join(","),null);!i.isEmpty();){const o=i.get();if(n&&o.join(",")===n.join(","))break;for(const s of e.neighbors(o))e.weights(o,s)!==1/0&&(r.has(s.join(","))||(i.put(s),r.set(s.join(","),o)))}return r}function Jo(e,t,n){let i=n,r=[];if(!e.has(n))return[];for(;i!==t;)r.push(i),i=e.get(i);return r.push(t),r.reverse(),r}function Ko(e,t,n){let i=n,r=[];if(!e.has(n.join(",")))return[];for(;i&&i.join(",")!==t.join(",");)r.push(i),i=e.get(i.join(","));return r.push(t),r.reverse(),r}function Qo(e,t){const[n,i]=e,[r,o]=t;return Math.abs(n-r)+Math.abs(i-o)}function Zo(e,t,n){const i=new Ae;i.put(t,0);let r=new Map,o=new Map;for(r.set(t.join(","),null),o.set(t.join(","),0);!i.isEmpty();){const s=i.get();if(s.join(",")===n.join(","))break;for(const a of e.neighbors(s)){if(e.weights(s,a)===1/0)continue;const l=o.get(s.join(","))+e.weights(s,a);if(!o.has(a.join(","))||l<o.get(a.join(","))){o.set(a.join(","),l);const h=l+Qo(a,n);i.put(a,h),r.set(a.join(","),s)}}}return r}var yi=(e=>(e[e.linear=0]="linear",e[e.square=1]="square",e[e.log=2]="log",e[e.power=3]="power",e[e.groupStretch=4]="groupStretch",e))(yi||{}),mi=(e=>(e[e.default=0]="default",e))(mi||{});function ie(e,t){return(e-t.min)/(t.max-t.min)}function gi(e,t){return Math.sqrt((e-t.min)/(t.max-t.min))}function wi(e,t){return Math.log((e-t.min)/(t.max-t.min)+1)}function Mi(e,t){return Math.pow((e-t.min)/(t.max-t.min),2)}function bi(e,t){let n=.1;return e<t.mean-n||e>t.mean+n?0:(e-t.min)/(t.max-t.min)}function Ee(e,t){switch(e){case 0:return t?(n,i)=>1-ie(n,i):ie;case 1:return t?(n,i)=>1-gi(n,i):gi;case 2:return t?(n,i)=>1-wi(n,i):wi;case 3:return t?(n,i)=>1-Mi(n,i):Mi;case 4:return t?(n,i)=>1-bi(n,i):bi;default:throw new Error("未知的拉伸类型")}}function Te(e,t,n=ie){let i=n(t,e),r=Math.floor(i*255);return`rgb(${r},${r},${r})`}function vi(e,t,n=ie){let i=Math.floor(n(t[0],e[0])*255),r=Math.floor(n(t[1],e[1])*255),o=Math.floor(n(t[2],e[2])*255);return`rgb(${i},${r},${o})`}function ts(e,t){return(n,i)=>vi(n,i,Ee(e,t))}function es(e,t){return(n,i)=>Te(n,i,Ee(e,t))}const pi=["#163544","#495a45","#767d58","#76a477","#d7bd7f","#d7221f"],Pi=["#ffffff00","#ff9a00","#3ec1d3","#6c5b7b","#355c7d","#f8b500","#119da4","#ff165d","#8ECFC9","#FFBE7A","#82B0D2","#BEB8DC","#E7DAD2","#119da4","#ff165d","#ffffff00"];function ns(e,t,n,i=pi,r=ie){let o=r(t,e),s=0;if(n===void 0)s=Math.floor(o*i.length);else for(let a=0;a<n.length;a++)if(o<n[a]){s=a;break}return i[s]}function is(e,t,n=pi){return(i,r)=>ns(i,r,t,n,Ee(e))}function Ai(e,t=["#000000","#ffffff"]){return e===0?t[0]:t[1]}function rs(e,t=Pi){return t[e]}function os(e,t=0,n){let i=new Array(256).fill(0),r=Ee(t);if(n===void 0){n={max:0,min:0,mean:0};for(let o=0;o<e.length;o++)for(let s=0;s<e[0].length;s++)n.max=Math.max(n.max,e[o][s]),n.min=Math.min(n.min,e[o][s]),n.mean+=e[o][s]}for(let o=0;o<e.length;o++)for(let s=0;s<e[0].length;s++){let a=r(e[o][s],n),l=Math.floor(a*255);i[l]+=1}return i}function ss(e,t,n,i,r){let o=n.w/t[0],s=n.h/t[1],a=e.getContext("2d");if(a===null)throw new Error("无法获取canvas绘图上下文");if(a.strokeStyle="red",a.lineWidth=1,i[0]&&i[1]){let[l,h]=Ei(t,n,i);a.strokeRect(n.x+l*o,n.y+h*s,o,s),r&&r(l,h)}}function Ei(e,t,n){let i=t.w/e[0],r=t.h/e[1],o=Math.floor((n[0]-t.x)/i),s=Math.floor((n[1]-t.y)/r);return[o,s]}function as(e,t,n,i,r=Te,o){let s=n.w/t[0].length,a=n.h/t.length,l=e.getContext("2d");if(l===null)throw new Error("无法获取canvas绘图上下文");for(let h=0;h<t.length;h++)for(let f=0;f<t[0].length;f++){let u=t[h][f],c=r(i,u);l.fillStyle=c,l.fillRect(n.x+f*s,n.y+h*a,s,a)}if(o){let[h,f,u,c]=o;l.strokeStyle="red",l.lineWidth=1,l.strokeRect(n.x+h*s,n.y+f*a,(u-h)*s,(c-f)*a)}l.restore()}function ls(e,t,n,i,r="gray",o){let s=n.w/t[0],a=n.h/t[1],l=e.getContext("2d");if(l===null)throw new Error("无法获取canvas绘图上下文");l.save();for(let h=0;h<t[0];h++)for(let f=0;f<t[1];f++){let u=i.get([f,h].join(","));if(u){let c=n.x+f*s+s/2,d=n.y+h*a+a/2,g=n.x+u[0]*s+s/2,M=n.y+u[1]*a+a/2;o&&o.find(([A,p])=>A===f&&p===h)?(Ti(l,c,d,g,M,"red"),u[0]===o[0][0]&&u[1]===o[0][1]&&(l.fillStyle="green",l.beginPath(),l.arc(g,M,10,0,2*Math.PI),l.fill()),u[0]===o[o.length-2][0]&&u[1]===o[o.length-2][1]&&(l.fillStyle="blue",l.beginPath(),l.arc(c,d,10,0,2*Math.PI),l.fill())):Ti(l,c,d,g,M,r)}else l.fillStyle=r,l.fillRect(n.x+f*s+s/2-2,n.y+h*a+a/2-2,4,4)}l.restore()}function Ti(e,t,n,i,r,o="green"){e.strokeStyle=o,e.lineWidth=2,e.beginPath(),e.moveTo(t,n),e.lineTo(i,r),e.stroke();let s=10,a=Math.atan2(r-n,i-t);e.beginPath(),e.moveTo(i,r),e.lineTo(i-s*Math.cos(a-Math.PI/6),r-s*Math.sin(a-Math.PI/6)),e.moveTo(i,r),e.lineTo(i-s*Math.cos(a+Math.PI/6),r-s*Math.sin(a+Math.PI/6)),e.stroke()}function us(e,t,n,i=Ai){let r=n.w/t[0].length,o=n.h/t.length,s=e.getContext("2d");if(s.save(),s===null)throw new Error("无法获取canvas绘图上下文");for(let a=0;a<t.length;a++)for(let l=0;l<t[0].length;l++){let h=t[a][l],f=i(h);s.fillStyle=f,s.fillRect(n.x+l*r,n.y+a*o,r,o)}s.restore()}function hs(e,t,n,i="white"){let r=n.w/(t[0].length+1),o=n.h/(t.length+1),s=e.getContext("2d");if(s.save(),s===null)throw new Error("无法获取canvas绘图上下文");for(let a=0;a<t.length;a++)for(let l=0;l<t[0].length;l++){let h=t[a][l],f={x:n.x+l*r+r/2,y:n.y+a*o+o/2,w:r,h:o};fs(h,f,s,i)}s.restore()}function fs(e,t,n,i="white"){switch(n.strokeStyle=i,e){case 0:break;case 1:n.beginPath(),n.moveTo(t.x,t.y+t.h/2),n.lineTo(t.x+t.w/2,t.y+t.h),n.stroke();break;case 2:n.beginPath(),n.moveTo(t.x+t.w/2,t.y+t.h),n.lineTo(t.x+t.w,t.y+t.h/2),n.stroke();break;case 3:n.beginPath(),n.moveTo(t.x,t.y+t.h/2),n.lineTo(t.x+t.w,t.y+t.h/2),n.stroke();break;case 4:n.beginPath(),n.moveTo(t.x+t.w/2,t.y),n.lineTo(t.x+t.w,t.y+t.h/2),n.stroke();break;case 5:n.beginPath(),n.moveTo(t.x,t.y+t.h/2),n.lineTo(t.x+t.w/2,t.y),n.stroke(),n.beginPath(),n.moveTo(t.x+t.w/2,t.y+t.h),n.lineTo(t.x+t.w,t.y+t.h/2),n.stroke();break;case 6:n.beginPath(),n.moveTo(t.x+t.w/2,t.y),n.lineTo(t.x+t.w/2,t.y+t.h),n.stroke();break;case 7:n.beginPath(),n.moveTo(t.x,t.y+t.h/2),n.lineTo(t.x+t.w/2,t.y),n.stroke();break;case 8:n.beginPath(),n.moveTo(t.x,t.y+t.h/2),n.lineTo(t.x+t.w/2,t.y),n.stroke();break;case 9:n.beginPath(),n.moveTo(t.x+t.w/2,t.y),n.lineTo(t.x+t.w/2,t.y+t.h),n.stroke();break;case 10:n.beginPath(),n.moveTo(t.x+t.w/2,t.y),n.lineTo(t.x+t.w,t.y+t.h/2),n.stroke(),n.beginPath(),n.moveTo(t.x,t.y+t.h/2),n.lineTo(t.x+t.w/2,t.y+t.h),n.stroke();break;case 11:n.beginPath(),n.moveTo(t.x+t.w/2,t.y),n.lineTo(t.x+t.w,t.y+t.h/2),n.stroke();break;case 12:n.beginPath(),n.moveTo(t.x,t.y+t.h/2),n.lineTo(t.x+t.w,t.y+t.h/2),n.stroke();break;case 13:n.beginPath(),n.moveTo(t.x+t.w/2,t.y+t.h),n.lineTo(t.x+t.w,t.y+t.h/2),n.stroke();break;case 14:n.beginPath(),n.moveTo(t.x,t.y+t.h/2),n.lineTo(t.x+t.w/2,t.y+t.h),n.stroke();break}}function re(e,t,n,i,r=Te,o,s){let a=e.getContext("2d");if(a===null)throw new Error("无法获取canvas绘图上下文");let h=i.getSubGridObj(n.boundary).getBandStatistics(0),f=h.mean;s?(s.max=Math.max(s.max,h.max),s.min=Math.min(s.min,h.min),s.mean=(s.mean+h.mean)/2):s=h,o||(o=f);let u=r(s,f);a.fillStyle=u,a.fillRect(t.x,t.y,t.w,t.h),requestAnimationFrame(()=>{if(n.isDivided){let c=[{x:t.x+t.w/2,y:t.y,w:t.w/2,h:t.h/2},{x:t.x+t.w/2,y:t.y+t.h/2,w:t.w/2,h:t.h/2},{x:t.x,y:t.y,w:t.w/2,h:t.h/2},{x:t.x,y:t.y+t.h/2,w:t.w/2,h:t.h/2}];re(e,c[0],n.children[0],i,r,o,s),re(e,c[1],n.children[1],i,r,o,s),re(e,c[2],n.children[2],i,r,o,s),re(e,c[3],n.children[3],i,r,o,s)}})}function cs(e,t,n,i={color:"black",backgroundColor:"rgba(0,0,0,0)"},r=!1,o){let s=e.getContext("2d");if(s===null)throw new Error("无法获取canvas绘图上下文");o||(o={max:Math.max(...n),min:Math.min(...n),mean:n.reduce((l,h)=>l+h)/n.length}),s.fillStyle=i.backgroundColor,s.fillRect(t.x,t.y,t.w,t.h),s.fillStyle=i.color,s.lineWidth=1;let a=2;for(let l=0;l<n.length;l++){let h=t.x+t.w*l/n.length,f=t.y+t.h*(1-(n[l]-o.min)/(o.max-o.min));s.beginPath(),s.arc(h,f,a,0,2*Math.PI),s.fill()}s.strokeStyle=i.color,s.beginPath(),s.moveTo(t.x,t.y+t.h*(1-(n[0]-o.min)/(o.max-o.min)));for(let l=0;l<n.length;l++){let h=t.x+t.w*l/n.length,f=t.y+t.h*(1-(n[l]-o.min)/(o.max-o.min));s.lineTo(h,f)}if(s.stroke(),s.strokeStyle="white",s.beginPath(),s.moveTo(t.x,t.y+12),s.lineTo(t.x+t.w,t.y+12),s.stroke(),s.beginPath(),s.moveTo(t.x,t.y+t.h),s.lineTo(t.x+t.w,t.y+t.h),s.stroke(),s.beginPath(),s.moveTo(t.x,t.y+t.h/2),s.lineTo(t.x+t.w,t.y+t.h/2),s.stroke(),s.fillText(o.max.toFixed(2),t.x,t.y+12),s.fillText(o.min.toFixed(2),t.x,t.y+t.h),s.fillText(o.mean.toFixed(2),t.x,t.y+t.h/2),r){s.fillStyle="green",s.font="12px serif";for(let l=0;l<n.length;l+=16){let h=t.x+t.w*l/n.length,f=t.y+t.h*(1-(n[l]-o.min)/(o.max-o.min));s.fillText(n[l].toFixed(2),h,f)}}}function ds(e,t,n,i={color:"black",backgroundColor:"rgba(0,0,0,0)"},r,o=!1){let s=e.getContext("2d");if(s===null)throw new Error("无法获取canvas绘图上下文");r||(r={max:Math.max(...n),min:Math.min(...n),mean:n.reduce((l,h)=>l+h)/n.length}),s.fillStyle=i.backgroundColor,s.fillRect(t.x,t.y,t.w,t.h),s.fillStyle=i.color;let a=t.w/n.length;for(let l=0;l<n.length;l++){let h=t.x+a*l,f=t.y+t.h*(1-(n[l]-r.min)/(r.max-r.min));s.fillRect(h,f,a,t.h-f+t.y)}o&&(s.fillStyle="green",s.font="12px serif",s.fillText(r.max.toFixed(2),t.x,t.y+12),s.fillText(r.min.toFixed(2),t.x,t.y+t.h),s.fillText(r.mean.toFixed(2),t.x,t.y+t.h/2)),s.strokeStyle="white",s.beginPath(),s.moveTo(t.x,t.y+12),s.lineTo(t.x+t.w,t.y+12),s.stroke(),s.beginPath(),s.moveTo(t.x,t.y+t.h),s.lineTo(t.x+t.w,t.y+t.h),s.stroke(),s.beginPath(),s.moveTo(t.x,t.y+t.h/2),s.lineTo(t.x+t.w,t.y+t.h/2),s.stroke()}function ys(e,t,n,i={color:"black",font:"12px serif"}){let r=e.getContext("2d");if(r===null)throw new Error("无法获取canvas绘图上下文");r.fillStyle=i.color,r.font=i.font,r.fillText(n,t.x,t.y)}function ms(e,t,n,i,r,o){let s=i.w/t.width,a=i.h/t.height,l=e.getContext("2d");if(l===null)throw new Error("无法获取canvas绘图上下文");let h=[],f=[];n.forEach(u=>{h.push(t.getBand(u)),f.push(t.getBandStatistics(u))});for(let u=0;u<t.height;u++)for(let c=0;c<t.width;c++){let d=n.map(M=>h[M][u][c]),g=r(f,d);l.fillStyle=g,l.fillRect(i.x+c*s,i.y+u*a,s,a)}if(o){let[u,c,d,g]=o;l.strokeStyle="red",l.lineWidth=1,l.strokeRect(i.x+u*s,i.y+c*a,(d-u)*s,(g-c)*a)}l.strokeStyle="red",l.lineWidth=1,l.beginPath(),l.moveTo(i.x+i.w/2,i.y+i.h/2-10),l.lineTo(i.x+i.w/2,i.y+i.h/2+10),l.stroke(),l.beginPath(),l.moveTo(i.x+i.w/2-10,i.y+i.h/2),l.lineTo(i.x+i.w/2+10,i.y+i.h/2),l.stroke()}function xi(e,t,n,i={color:"green",width:4,backgroundColor:"rgba(0,0,0,1)"}){let r=e.getContext("2d");if(r===null)throw new Error("无法获取canvas绘图上下文");r.fillStyle=i.backgroundColor,r.fillRect(t.x,t.y,t.w,t.h),r.fillStyle=i.color,r.fillRect(t.x,t.y,t.w*n/100,t.h),r.strokeStyle="white",r.lineWidth=1;for(let o=0;o<10;o++)r.beginPath(),r.moveTo(t.x+t.w*o/10,t.y),r.lineTo(t.x+t.w*o/10,t.y+t.h),r.stroke();t.h>=20&&t.w>=40&&(r.fillStyle="white",r.font="20px serif",r.fillText(n+"%",t.x+t.w/2-20,t.y+t.h/2+6))}function gs(){let e=document.createElement("canvas");e.width=200,e.height=20,document.body.appendChild(e);let t={x:0,y:0,w:200,h:20},n=0;setInterval(()=>{xi(e,t,n),n+=1,n>100&&(n=0)},100)}const Si=Math.pow(2,-52),xe=new Uint32Array(512),ws=At.unproject;class qt{static from(t,n=Ii,i=Ci){const r=t.length,o=new Float64Array(r*2);for(let s=0;s<r;s++){const a=t[s];o[2*s]=n(a),o[2*s+1]=i(a)}return new qt(o)}constructor(t){const n=t.length>>1;if(n>0&&typeof t[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=t;const i=Math.max(2*n-5,0);this._triangles=new Uint32Array(i*3),this._halfedges=new Int32Array(i*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:t,_hullPrev:n,_hullNext:i,_hullTri:r,_hullHash:o}=this,s=t.length>>1;let a=1/0,l=1/0,h=-1/0,f=-1/0;for(let I=0;I<s;I++){const W=t[2*I],R=t[2*I+1];W<a&&(a=W),R<l&&(l=R),W>h&&(h=W),R>f&&(f=R),this._ids[I]=I}const u=(a+h)/2,c=(l+f)/2;let d,g,M;for(let I=0,W=1/0;I<s;I++){const R=sn(u,c,t[2*I],t[2*I+1]);R<W&&(d=I,W=R)}const A=t[2*d],p=t[2*d+1];for(let I=0,W=1/0;I<s;I++){if(I===d)continue;const R=sn(A,p,t[2*I],t[2*I+1]);R<W&&R>0&&(g=I,W=R)}let E=t[2*g],G=t[2*g+1],L=1/0;for(let I=0;I<s;I++){if(I===d||I===g)continue;const W=vs(A,p,E,G,t[2*I],t[2*I+1]);W<L&&(M=I,L=W)}let F=t[2*M],j=t[2*M+1];if(L===1/0){for(let R=0;R<s;R++)this._dists[R]=t[2*R]-t[0]||t[2*R+1]-t[1];Ht(this._ids,this._dists,0,s-1);const I=new Uint32Array(s);let W=0;for(let R=0,z=-1/0;R<s;R++){const U=this._ids[R],y=this._dists[U];y>z&&(I[W++]=U,z=y)}this.hull=I.subarray(0,W),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(te(A,p,E,G,F,j)<0){const I=g,W=E,R=G;g=M,E=F,G=j,M=I,F=W,j=R}const Y=this.circumcenter(A,p,E,G,F,j);this._cx=Y.x,this._cy=Y.y;for(let I=0;I<s;I++)this._dists[I]=sn(t[2*I],t[2*I+1],Y.x,Y.y);Ht(this._ids,this._dists,0,s-1),this._hullStart=d;let X=3;i[d]=n[M]=g,i[g]=n[d]=M,i[M]=n[g]=d,r[d]=0,r[g]=1,r[M]=2,o.fill(-1),o[this._hashKey(A,p)]=d,o[this._hashKey(E,G)]=g,o[this._hashKey(F,j)]=M,this.trianglesLen=0,this._addTriangle(d,g,M,-1,-1,-1);for(let I=0,W,R;I<this._ids.length;I++){const z=this._ids[I],U=t[2*z],y=t[2*z+1];if(I>0&&Math.abs(U-W)<=Si&&Math.abs(y-R)<=Si||(W=U,R=y,z===d||z===g||z===M))continue;let w=0;for(let v=0,S=this._hashKey(U,y);v<this._hashSize&&(w=o[(S+v)%this._hashSize],!(w!==-1&&w!==i[w]));v++);w=n[w];let b=w,P;for(;P=i[b],te(U,y,t[2*b],t[2*b+1],t[2*P],t[2*P+1])>=0;)if(b=P,b===w){b=-1;break}if(b===-1)continue;let T=this._addTriangle(b,z,i[b],-1,-1,r[b]);r[z]=this._legalize(T+2),r[b]=T,X++;let C=i[b];for(;P=i[C],te(U,y,t[2*C],t[2*C+1],t[2*P],t[2*P+1])<0;)T=this._addTriangle(C,z,P,r[z],-1,r[C]),r[z]=this._legalize(T+2),i[C]=C,X--,C=P;if(b===w)for(;P=n[b],te(U,y,t[2*P],t[2*P+1],t[2*b],t[2*b+1])<0;)T=this._addTriangle(P,z,b,-1,r[b],r[P]),this._legalize(T+2),r[P]=T,i[b]=b,X--,b=P;this._hullStart=n[z]=b,i[b]=n[C]=z,i[z]=C,o[this._hashKey(U,y)]=z,o[this._hashKey(t[2*b],t[2*b+1])]=b}this.hull=new Uint32Array(X);for(let I=0,W=this._hullStart;I<X;I++)this.hull[I]=W,W=i[W];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(t,n){return Math.floor(Ms(t-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(t){const{_triangles:n,_halfedges:i,coords:r}=this;let o=0,s=0;for(;;){const a=i[t],l=t-t%3;if(s=l+(t+2)%3,a===-1){if(o===0)break;t=xe[--o];continue}const h=a-a%3,f=l+(t+1)%3,u=h+(a+2)%3,c=n[s],d=n[t],g=n[f],M=n[u];if(bs(r[2*c],r[2*c+1],r[2*d],r[2*d+1],r[2*g],r[2*g+1],r[2*M],r[2*M+1])){n[t]=M,n[a]=c;const p=i[u];if(p===-1){let G=this._hullStart;do{if(this._hullTri[G]===u){this._hullTri[G]=t;break}G=this._hullPrev[G]}while(G!==this._hullStart)}this._link(t,p),this._link(a,i[s]),this._link(s,u);const E=h+(a+1)%3;o<xe.length&&(xe[o++]=E)}else{if(o===0)break;t=xe[--o]}}return s}_link(t,n){this._halfedges[t]=n,n!==-1&&(this._halfedges[n]=t)}_addTriangle(t,n,i,r,o,s){const a=this.trianglesLen;return this._triangles[a]=t,this._triangles[a+1]=n,this._triangles[a+2]=i,this._link(a,r),this._link(a+1,o),this._link(a+2,s),this.trianglesLen+=3,a}getTriangles(){return this.triangles}getHalfedges(){return this.halfedges}getHull(){return this.hull}getPoints(){let t=[];for(let n=0;n<this.coords.length;n+=2)t.push([this.coords[n],this.coords[n+1]]);return t}getTriangleIndices(){let t=[];for(let n=0;n<this.triangles.length;n+=3)t.push([this.triangles[n],this.triangles[n+1],this.triangles[n+2]]);return t}static circumRadius(t,n,i){const r=n[0]-t[0],o=n[1]-t[1],s=i[0]-t[0],a=i[1]-t[1],l=r*r+o*o,h=s*s+a*a,f=.5/(r*a-o*s),u=(a*l-o*h)*f,c=(r*h-s*l)*f;return u*u+c*c}circumcenter(t,n,i,r,o,s){const a=i-t,l=r-n,h=o-t,f=s-n,u=a*a+l*l,c=h*h+f*f,d=.5/(a*f-l*h),g=t+(f*u-l*c)*d,M=n+(a*c-h*u)*d;return{x:g,y:M}}}function Ms(e,t){const n=e/(Math.abs(e)+Math.abs(t));return(t>0?3-n:1+n)/4}function sn(e,t,n,i){const r=e-n,o=t-i;return r*r+o*o}function bs(e,t,n,i,r,o,s,a){const l=e-s,h=t-a,f=n-s,u=i-a,c=r-s,d=o-a,g=l*l+h*h,M=f*f+u*u,A=c*c+d*d;return l*(u*A-M*d)-h*(f*A-M*c)+g*(f*d-u*c)<0}function vs(e,t,n,i,r,o){const s=n-e,a=i-t,l=r-e,h=o-t,f=s*s+a*a,u=l*l+h*h,c=.5/(s*h-a*l),d=(h*f-a*u)*c,g=(s*u-l*f)*c;return d*d+g*g}function Ht(e,t,n,i){if(i-n<=20)for(let r=n+1;r<=i;r++){const o=e[r],s=t[o];let a=r-1;for(;a>=n&&t[e[a]]>s;)e[a+1]=e[a--];e[a+1]=o}else{const r=n+i>>1;let o=n+1,s=i;oe(e,r,o),t[e[n]]>t[e[i]]&&oe(e,n,i),t[e[o]]>t[e[i]]&&oe(e,o,i),t[e[n]]>t[e[o]]&&oe(e,n,o);const a=e[o],l=t[a];for(;;){do o++;while(t[e[o]]<l);do s--;while(t[e[s]]>l);if(s<o)break;oe(e,o,s)}e[n+1]=e[s],e[s]=a,i-o+1>=s-n?(Ht(e,t,o,i),Ht(e,t,n,s-1)):(Ht(e,t,n,s-1),Ht(e,t,o,i))}}function oe(e,t,n){const i=e[t];e[t]=e[n],e[n]=i}function Ii(e){return e[0]}function Ci(e){return e[1]}function ps(e){return[3*e,3*e+1,3*e+2]}function Ps(e,t){return ps(t).map(n=>e.triangles[n])}function As(e){return Math.floor(e/3)}function Es(e,t,n){const i=e[0]*e[0]+e[1]*e[1],r=t[0]*t[0]+t[1]*t[1],o=n[0]*n[0]+n[1]*n[1],s=2*(e[0]*(t[1]-n[1])+t[0]*(n[1]-e[1])+n[0]*(e[1]-t[1]));return[1/s*(i*(t[1]-n[1])+r*(n[1]-e[1])+o*(e[1]-t[1])),1/s*(i*(n[0]-t[0])+r*(e[0]-n[0])+o*(t[0]-e[0]))]}function Fi(e,t,n,i=ws){const r=Ps(t,n).map(s=>e[s]);let o=Es(r[0],r[1],r[2]);return i&&(o=i(o)),o}function ki(e){return e%3===2?e-2:e+1}function Ts(e,t){const n=[];let i=t;do{n.push(i);const r=ki(i);i=e.halfedges[r]}while(i!==-1&&i!==t);return n}function an(e,t,n){const i=new Set;for(let r=0;r<t.triangles.length;r++){const o=t.triangles[ki(r)];if(!i.has(o)){i.add(o);const l=Ts(t,r).map(As).map(h=>Fi(e,t,h));n(o,l)}}}class xs{constructor(t,n=Ii,i=Ci){H(this,"delaunay");H(this,"points");t instanceof qt?(this.delaunay=t,this.points=t.getPoints()):(this.points=t,this.delaunay=qt.from(t,n,i))}getVoronoi(){const{points:t,delaunay:n}=this,i=new Map;return an(t,n,(r,o)=>i.set(r,o)),i}cutVoronoiByMBR(t){const{points:n,delaunay:i}=this,r=new Map;return an(n,i,(o,s)=>{this.isInsideMBR(s,t)||(console.log(s),s=ai(s,t)),r.set(o,s)}),r}robustVoronoi(t){const{points:n,delaunay:i}=this,r=new Map;return an(n,i,(o,s)=>{this.isInsideMBR(s,t)&&r.set(o,s)}),r}isInsideMBR(t,n){const[i,r,o,s]=n;for(let a=0;a<t.length;a++){const[l,h]=t[a];if(l<i||l>o||h<r||h>s)return!1}return!0}}function Ss(e,t){const n=new Map;for(let[i,r]of e)t.has(i)?n.set(i,t.get(i)):n.set(i,r);return n}function Is(e){const t=e.map((o,s)=>[...o.toXY(),s]);let n=t[0];for(let o=1;o<t.length;o++)t[o][1]<n[1]&&(n=t[o]);t.sort((o,s)=>{let a=Qe([n[0],n[1]],[o[0],o[1]]),l=Qe([n[0],n[1]],[s[0],s[1]]);if(a<l)return-1;if(a>l)return 1;{let h=Math.pow(o[0]-n[0],2)+Math.pow(o[1]-n[1],2),f=Math.pow(s[0]-n[0],2)+Math.pow(s[1]-n[1],2);return h<f?-1:1}});let i=[];i.push(t[0]),i.push(t[1]);for(let o=2;o<t.length;o++){for(;i.length>1&&Ke([i[i.length-2][0],i[i.length-2][1]],[i[i.length-1][0],i[i.length-1][1]],[t[o][0],t[o][1]])<=0;)i.pop();i.push(t[o])}let r=[];for(let o=0;o<i.length;o++){let s=i[o][2];r.push(e[s])}return r}function Cs(e,t){let n=e.map(s=>s.toXY());return qt.from(n).getTriangleIndices().filter(s=>{let a=[n[s[0]],n[s[1]],n[s[2]]];return qt.circumRadius(a[0],a[1],a[2])*t<1})}m.Circle=en,m.CountourColorList=Pi,m.D2R=tt,m.Delaunator=qt,m.EPSG3857=di,m.EPSG900913=Wo,m.EPSLN=dn,m.Earth=fi,m.Evented=pr,m.FFT=An,m.FFT2=_e,m.FFTImag=Fn,m.FFTImag2=fr,m.FFTReal=kn,m.FFTReal2=cr,m.FFTShift=Gn,m.Geometry=$t,m.GeometryCollection=Ot,m.Grid=pe,m.IFFT=En,m.IFFT2=hr,m.IFFTReal=xn,m.IFFTReal2=ur,m.K_means=Ar,m.LineString=Pt,m.MBR2Plane=Qr,m.MultiLineString=zt,m.MultiPoint=bt,m.MultiPolygon=Ut,m.Perlin=Go,m.Point=ut,m.PointInsidePolygon=bo,m.PointOutsideMBR=si,m.Polygon=Et,m.PriorityQueue=Ae,m.QuadTree=Vt,m.Queue=on,m.R2D=Dt,m.Sin3D=_o,m.SphericalMercator=At,m.UUID=gr,m.Voronoi=xs,m.XY2ColRow=Ei,m.acos=yn,m.add=$i,m.adjust_lon=Ao,m.alphaComplex=Cs,m.applyMixins=dr,m.areaFactors=Ce,m.areaToArea=ji,m.asin=mn,m.atan2=cn,m.bearing=Qi,m.binDrawGrid2d=us,m.binarization=So,m.binaryColorBand=Ai,m.breadthFirstSearch=Vo,m.calculateArrayShape=wr,m.calculateMBR=vo,m.cartesian=Kt,m.cartesianAdd=Yi,m.cartesianAddInPlace=Ni,m.cartesianAngle=fe,m.cartesianCross=he,m.cartesianDot=ue,m.cartesianNormalize=wn,m.cartesianNormalizeInPlace=Wi,m.cartesianScale=gn,m.ccw=Ke,m.ccwRobust=Eo,m.collectionFromFeature=rn,m.collectionFromGeometry=hi,m.colorListType=mi,m.complateMap=Ss,m.concatEL2DArray=Mr,m.conj=or,m.containsMBR=to,m.convexHull=Is,m.cos=Ge,m.createGraph=zo,m.createGridGraph=Uo,m.cross=Gt,m.cutPolygonByMBR=ai,m.dampedSin3D=Lo,m.deMaxMin=Fo,m.degToDMS=Oi,m.degreesToRadians=Fe,m.destination=nr,m.dijkstra=$o,m.dmsToDeg=Ri,m.dot=Xi,m.drawArrowField=ls,m.drawCountour=hs,m.drawGrid2d=as,m.drawProgress=xi,m.drawQTree2d=re,m.drawSample=cs,m.drawSample2=ds,m.drawText=ys,m.drawTrueColorGrid2d=ms,m.earthRadius=dt,m.emptyObj=mr,m.equals=qi,m.equalsMBR=no,m.extend=je,m.factors=Se,m.factors2=Ie,m.fastFFT2=lr,m.feature=Xr,m.fillIndexArray=jn,m.flattenArray=_n,m.formatNum=Ji,m.fromFeatureObj=ui,m.fromGeometryObj=nn,m.getAngle=Qe,m.getMBRWithAntimeridian=ro,m.getPointsMBR=Ne,m.gridAstar=Zo,m.gridBreadthFirstSearch=Ho,m.gridDijkstra=Xo,m.gridReconstructPath=Ko,m.halfPi=Be,m.haversin=Di,m.haversine=Qt,m.hist=os,m.inCircle=xo,m.inCircleRobust=To,m.intermediatePoint=tr,m.interpolate=Vi,m.interpolate2=Hi,m.intersection=Je,m.intersectionPolygon=li,m.intersectsMBR=Jn,m.isEPSG3857=No,m.isEPSG4326=Yo,m.isFloat=Ki,m.isPotentialGeoObject=Ln,m.iterPolygonEdge=po,m.lengthToRadians=Gi,m.mbrToPolygon=Qn,m.mbrToRectangle=Kn,m.merge=Hr,m.mergeArcs=Vn,m.mergeMBR=Hn,m.mergePointMBR=Kr,m.mesh=zr,m.meshArcs=Un,m.metersTo=un,m.midpoint=Zi,m.neighbors=$r,m.normalize=Ui,m.object=Zt,m.overlapsMBR=eo,m.pi=ke,m.plane2MBR=Zr,m.planeIntersection=ir,m.planePolygonArea=Mn,m.pointInEdge=ve,m.pointInMBR=ge,m.pointInMBRWithAntimeridian=io,m.prePointInPolygon=Po,m.pseudoColorBandFactory=is,m.radiansToDegrees=Li,m.radiansToLength=Bi,m.randomIndexArray=Rn,m.reactGrid2d=ss,m.reconstructPath=Jo,m.rectangleToMBR=so,m.reverse=Xn,m.round=vr,m.sample=rr,m.scale=zi,m.sign=Xt,m.simpleColorBand=Te,m.simpleColorBandFactory=es,m.simplePseudoColorBand=rs,m.sin=ae,m.sphereIntersection=er,m.spherical=Jt,m.sphericalArea=Le,m.splitMBRWithAntimeridian=oo,m.sqrt=le,m.squareMetersTo=fn,m.stretchType=yi,m.subColumnInEL2DArray=br,m.subdivide2QTree=Io,m.testProgress=gs,m.throttle=yr,m.toLineString=Do,m.toMeters=ln,m.toMultiPoint=qo,m.toPoint=Oo,m.toSquareMeters=hn,m.topology=Dr,m.transform=Wn,m.triangleCenter=Fi,m.trueColorBand=vi,m.trueColorBandFactory=ts,m.unitToUnit=_i,m.untransform=Wr,m.worleyNoise=jo,m.zebraNoise=Ro,Object.defineProperty(m,Symbol.toStringTag,{value:"Module"})});
